var rudderanalytics=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(n,!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var c=4,l={setLogLevel:function(e){switch(e.toUpperCase()){case"INFO":return void(c=1);case"DEBUG":return void(c=2);case"WARN":return void(c=3)}},info:function(){var e;c<=1&&(e=console).info.apply(e,arguments)},debug:function(){var e;c<=2&&(e=console).debug.apply(e,arguments)},warn:function(){var e;c<=3&&(e=console).warn.apply(e,arguments)},error:function(){var e;c<=4&&(e=console).error.apply(e,arguments)}};function d(e,t){return null==t?void 0:t}function f(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function p(){return(new Date).toISOString()}function h(e){var t=e.message?e.message:void 0;e instanceof Event&&e.target&&"script"==e.target.localName&&(t="error in script loading: "+e.target.id),t&&l.error(t)}function g(){var e=y(),t=e?e.pathname:window.location.pathname,n=document.referrer,r=window.location.search;return{path:t,referrer:n,search:r,title:document.title,url:function(e){var t=y(),n=t?t.indexOf("?")>-1?t:t+e:window.location.href,r=n.indexOf("#");return r>-1?n.slice(0,r):n}(r)}}function y(){for(var e,t=document.getElementsByTagName("link"),n=0;e=t[n];n++)if("canonical"===e.getAttribute("rel"))return e.getAttribute("href")}function m(e,t){var n=e.revenue;return!n&&t&&t.match(/^[ _]?completed[ _]?order[ _]?|^[ _]?order[ _]?completed[ _]?$/i)&&(n=e.total),function(e){if(e){if("number"==typeof e)return e;if("string"==typeof e)return e=e.replace(/\$/g,""),e=parseFloat(e),isNaN(e)?void 0:e}}(n)}var v={TRACK:"track",PAGE:"page",IDENTIFY:"identify"},b={PRODUCTS_SEARCHED:"Products Searched",PRODUCT_LIST_VIEWED:"Product List Viewed",PRODUCT_LIST_FILTERED:"Product List Filtered",PROMOTION_VIEWED:"Promotion Viewed",PROMOTION_CLICKED:"Promotion Clicked",PRODUCT_CLICKED:"Product Clicked",PRODUCT_VIEWED:"Product Viewed",PRODUCT_ADDED:"Product Added",PRODUCT_REMOVED:"Product Removed",CART_VIEWED:"Cart Viewed",CHECKOUT_STARTED:"Checkout Started",CHECKOUT_STEP_VIEWED:"Checkout Step Viewed",CHECKOUT_STEP_COMPLETED:"Checkout Step Completed",PAYMENT_INFO_ENTERED:"Payment Info Entered",ORDER_UPDATED:"Order Updated",ORDER_COMPLETED:"Order Completed",ORDER_REFUNDED:"Order Refunded",ORDER_CANCELLED:"Order Cancelled",COUPON_ENTERED:"Coupon Entered",COUPON_APPLIED:"Coupon Applied",COUPON_DENIED:"Coupon Denied",COUPON_REMOVED:"Coupon Removed",PRODUCT_ADDED_TO_WISHLIST:"Product Added to Wishlist",PRODUCT_REMOVED_FROM_WISHLIST:"Product Removed from Wishlist",WISH_LIST_PRODUCT_ADDED_TO_CART:"Wishlist Product Added to Cart",PRODUCT_SHARED:"Product Shared",CART_SHARED:"Cart Shared",PRODUCT_REVIEWED:"Product Reviewed"},w="http://18.222.145.124:5000/dump";function k(e,t){l.debug("in script loader=== "+e);var n=document.createElement("script");n.src=t,n.type="text/javascript",n.id=e;var r=document.getElementsByTagName("script")[0];l.debug("==script==",r),r.parentNode.insertBefore(n,r)}var _=function(){function e(t){n(this,e),this.hubId=t.hubID,this.name="HS"}return i(e,[{key:"init",value:function(){k("hubspot-integration","http://js.hs-scripts.com/"+this.hubId+".js"),l.debug("===in init HS===")}},{key:"identify",value:function(e){l.debug("in HubspotAnalyticsManager identify");var n=e.message.context.traits,r={};for(var i in n)if(Object.getOwnPropertyDescriptor(n,i)&&n[i]){var o=i;"[object Date]"==toString.call(n[i])?r[o]=n[i].getTime():r[o]=n[i]}var s=e.message.context.user_properties;for(var a in s){if(Object.getOwnPropertyDescriptor(s,a)&&s[a])r[a]=s[a]}(l.debug(r),void 0!==("undefined"==typeof window?"undefined":t(window)))&&(window._hsq=window._hsq||[]).push(["identify",r])}},{key:"track",value:function(e){l.debug("in HubspotAnalyticsManager track");var t=window._hsq=window._hsq||[],n={};n.id=e.message.event,e.message.properties&&(e.message.properties.revenue||e.message.properties.value)&&(n.value=e.message.properties.revenue||e.message.properties.value),t.push(["trackEvent",n])}},{key:"page",value:function(e){l.debug("in HubspotAnalyticsManager page");var t=window._hsq=window._hsq||[];e.message.properties&&e.message.properties.path&&t.push(["setPath",e.message.properties.path]),t.push(["trackPageView"])}},{key:"isLoaded",value:function(){return l.debug("in hubspot isLoaded"),!(!window._hsq||window._hsq.push===Array.prototype.push)}},{key:"isReady",value:function(){return!(!window._hsq||window._hsq.push===Array.prototype.push)}}]),e}(),E=function(){function e(t){n(this,e),this.trackingID=t.trackingID,this.name="GA"}return i(e,[{key:"init",value:function(){!function(e,t,n,r,i,o,s){e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,o=t.createElement(n),s=t.getElementsByTagName(n)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create",this.trackingID,"auto"),ga("send","pageview"),l.debug("===in init GA===")}},{key:"identify",value:function(e){ga("set","userId",e.message.anonymous_id),l.debug("in GoogleAnalyticsManager identify")}},{key:"track",value:function(e){var t=e.message.event,n=e.message.event,r=e.message.event,i="";e.message.properties&&(i=e.message.properties.value?e.message.properties.value:e.message.properties.revenue),ga("send","event",{hitType:"event",eventCategory:t,eventAction:n,eventLabel:r,eventValue:i}),l.debug("in GoogleAnalyticsManager track")}},{key:"page",value:function(e){l.debug("in GoogleAnalyticsManager page");var t=e.properties&&e.properties.path?e.properties.path:void 0;t&&ga("set","page",t),ga("send","pageview")}},{key:"isLoaded",value:function(){return l.debug("in GA isLoaded"),!!window.gaplugins}},{key:"isReady",value:function(){return!!window.gaplugins}}]),e}(),I=function(){function e(t){n(this,e),this.siteId=t.siteID,this.name="HOTJAR",this._ready=!1}return i(e,[{key:"init",value:function(){window.hotjarSiteId=this.siteId,function(e,t,n,r,i,o){e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},e._hjSettings={hjid:e.hotjarSiteId,hjsv:6},i=t.getElementsByTagName("head")[0],(o=t.createElement("script")).async=1,o.src="https://static.hotjar.com/c/hotjar-"+e._hjSettings.hjid+".js?sv="+e._hjSettings.hjsv,i.appendChild(o)}(window,document),this._ready=!0,l.debug("===in init Hotjar===")}},{key:"identify",value:function(e){if(e.message.userId||e.message.anonymousId){var t=e.message.context.traits;window.hj("identify",e.message.userId,t)}else l.error("user id is required")}},{key:"track",value:function(e){l.error("method not supported")}},{key:"page",value:function(e){l.error("method not supported")}},{key:"isLoaded",value:function(){return this._ready}},{key:"isReady",value:function(){return this._ready}}]),e}(),A=function(){function e(t){n(this,e),this.conversionId=t.conversionID,this.pageLoadConversions=t.pageLoadConversions,this.clickEventConversions=t.clickEventConversions,this.name="GOOGLEADS"}return i(e,[{key:"init",value:function(){!function(e,t,n){l.debug("in script loader=== "+e);var r=n.createElement("script");r.src=t,r.async=1,r.type="text/javascript",r.id=e;var i=n.getElementsByTagName("head")[0];l.debug("==script==",i),i.appendChild(r)}("googleAds-integration","https://www.googletagmanager.com/gtag/js?id="+this.conversionId,document),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",this.conversionId),l.debug("===in init Google Ads===")}},{key:"identify",value:function(e){l.error("method not supported")}},{key:"track",value:function(e){l.debug("in GoogleAdsAnalyticsManager track");var t=this.getConversionData(this.clickEventConversions,e.message.event);if(t.conversionLabel){var n=t.conversionLabel,r=t.eventName,i=this.conversionId+"/"+n,o={};e.properties&&(o.value=e.properties.revenue,o.currency=e.properties.currency,o.transaction_id=e.properties.order_id),o.send_to=i,window.gtag("event",r,o)}}},{key:"page",value:function(e){l.debug("in GoogleAdsAnalyticsManager page");var t=this.getConversionData(this.pageLoadConversions,e.message.name);if(t.conversionLabel){var n=t.conversionLabel,r=t.eventName;window.gtag("event",r,{send_to:this.conversionId+"/"+n})}}},{key:"getConversionData",value:function(e,t){var n={};return e&&e.forEach((function(e){if(e.name.toLowerCase()===t.toLowerCase())return n.conversionLabel=e.conversionLabel,void(n.eventName=e.name)})),n}},{key:"isLoaded",value:function(){return window.dataLayer.push!==Array.prototype.push}},{key:"isReady",value:function(){return window.dataLayer.push!==Array.prototype.push}}]),e}(),T=function(){function e(t){n(this,e),this.accountId=t.accountId,this.settingsTolerance=t.settingsTolerance,this.isSPA=t.isSPA,this.libraryTolerance=t.libraryTolerance,this.useExistingJquery=t.useExistingJquery,this.sendExperimentTrack=t.sendExperimentTrack,this.sendExperimentIdentify=t.sendExperimentIdentify,this.name="VWO",l.debug("Config ",t)}return i(e,[{key:"init",value:function(){l.debug("===in init VWO===");var e=this.accountId,t=this.settingsTolerance,n=this.libraryTolerance,r=this.useExistingJquery,i=this.isSPA;window._vwo_code=function(){var o=!1,s=document;return{use_existing_jquery:function(){return r},library_tolerance:function(){return n},finish:function(){if(!o){o=!0;var e=s.getElementById("_vis_opt_path_hides");e&&e.parentNode.removeChild(e)}},finished:function(){return o},load:function(e){var t=s.createElement("script");t.src=e,t.type="text/javascript",t.innerText,t.onerror=function(){_vwo_code.finish()},s.getElementsByTagName("head")[0].appendChild(t)},init:function(){var n=setTimeout("_vwo_code.finish()",t),r=s.createElement("style"),o="body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}",a=s.getElementsByTagName("head")[0];return r.setAttribute("id","_vis_opt_path_hides"),r.setAttribute("type","text/css"),r.styleSheet?r.styleSheet.cssText=o:r.appendChild(s.createTextNode(o)),a.appendChild(r),this.load("//dev.visualwebsiteoptimizer.com/j.php?a="+e+"&u="+encodeURIComponent(s.URL)+"&r="+Math.random()+"&f="+ +i),n}}}(),window._vwo_settings_timer=window._vwo_code.init(),(this.sendExperimentTrack||this.experimentViewedIdentify)&&this.experimentViewed()}},{key:"experimentViewed",value:function(){window.VWO=window.VWO||[];var e=this;window.VWO.push(["onVariationApplied",function(t){if(t){l.debug("Variation Applied");var n=t[1],r=t[2];if(l.debug("experiment id:",n,"Variation Name:",_vwo_exp[n].comb_n[r]),void 0!==_vwo_exp[n].comb_n[r]&&["VISUAL_AB","VISUAL","SPLIT_URL","SURVEY"].indexOf(_vwo_exp[n].type)>-1){try{e.sendExperimentTrack&&(l.debug("Tracking..."),window.rudderanalytics.track("Experiment Viewed",{experimentId:n,variationName:_vwo_exp[n].comb_n[r]}))}catch(e){l.error(e)}try{e.sendExperimentIdentify&&(l.debug("Identifying..."),window.rudderanalytics.identify(o({},"Experiment: ".concat(n),_vwo_exp[n].comb_n[r])))}catch(e){l.error(e)}}}}])}},{key:"identify",value:function(e){l.debug("method not supported")}},{key:"track",value:function(e){if("Order Completed"===e.message.event){var t=e.message.properties?e.message.properties.total||e.message.properties.revenue:0;l.debug("Revenue",t),window.VWO=window.VWO||[],window.VWO.push(["track.revenueConversion",t])}}},{key:"page",value:function(e){l.debug("method not supported")}},{key:"isLoaded",value:function(){return!!window._vwo_code}},{key:"isReady",value:function(){return!!window._vwo_code}}]),e}(),C=function(){function e(t){n(this,e),this.containerID=t.containerID,this.name="GOOGLETAGMANAGER"}return i(e,[{key:"init",value:function(){l.debug("===in init GoogleTagManager==="),function(e,t,n,r,i){e[r]=e[r]||[],e[r].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var o=t.getElementsByTagName(n)[0],s=t.createElement(n);s.async=!0,s.src="https://www.googletagmanager.com/gtm.js?id="+i,o.parentNode.insertBefore(s,o)}(window,document,"script","dataLayer",this.containerID)}},{key:"identify",value:function(e){l.error("method not supported")}},{key:"track",value:function(e){l.debug("===in track GoogleTagManager===");var t=e.message,n=a({event:t.event,userId:t.userId,anonymousId:t.anonymousId},t.properties);this.sendToGTMDatalayer(n)}},{key:"page",value:function(e){l.debug("===in page GoogleTagManager===");var t,n=e.message,r=n.name,i=n.properties?n.properties.category:void 0;r&&(t="Viewed "+r+" page"),i&&r&&(t="Viewed "+i+" "+r+" page");var o=a({event:t,userId:n.userId,anonymousId:n.anonymousId},n.properties);this.sendToGTMDatalayer(o)}},{key:"isLoaded",value:function(){return!(!window.dataLayer||Array.prototype.push===window.dataLayer.push)}},{key:"sendToGTMDatalayer",value:function(e){window.dataLayer.push(e)}},{key:"isReady",value:function(){return!(!window.dataLayer||Array.prototype.push===window.dataLayer.push)}}]),e}(),O=function(){function e(t,r){if(n(this,e),this.analytics=r,this.appKey=t.appKey,t.appKey||(this.appKey=""),this.endPoint="",t.dataCenter){var i=t.dataCenter.trim().split("-");"eu"===i[0].toLowerCase()?this.endPoint="sdk.fra-01.braze.eu":this.endPoint="sdk.iad-"+i[1]+".braze.com"}this.name="BRAZE",l.debug("Config ",t)}return i(e,[{key:"formatGender",value:function(e){if(e&&"string"==typeof e){return["woman","female","w","f"].indexOf(e.toLowerCase())>-1?window.appboy.ab.User.Genders.FEMALE:["man","male","m"].indexOf(e.toLowerCase())>-1?window.appboy.ab.User.Genders.MALE:["other","o"].indexOf(e.toLowerCase())>-1?window.appboy.ab.User.Genders.OTHER:void 0}}},{key:"init",value:function(){l.debug("===in init Braze==="),function(e,t,n,r,i){e.appboy={},e.appboyQueue=[];for(var o="initialize destroy getDeviceId toggleAppboyLogging setLogger openSession changeUser requestImmediateDataFlush requestFeedRefresh subscribeToFeedUpdates requestContentCardsRefresh subscribeToContentCardsUpdates logCardImpressions logCardClick logCardDismissal logFeedDisplayed logContentCardsDisplayed logInAppMessageImpression logInAppMessageClick logInAppMessageButtonClick logInAppMessageHtmlClick subscribeToNewInAppMessages subscribeToInAppMessage removeSubscription removeAllSubscriptions logCustomEvent logPurchase isPushSupported isPushBlocked isPushGranted isPushPermissionGranted registerAppboyPushMessages unregisterAppboyPushMessages trackLocation stopWebTracking resumeWebTracking wipeData ab ab.DeviceProperties ab.User ab.User.Genders ab.User.NotificationSubscriptionTypes ab.User.prototype.getUserId ab.User.prototype.setFirstName ab.User.prototype.setLastName ab.User.prototype.setEmail ab.User.prototype.setGender ab.User.prototype.setDateOfBirth ab.User.prototype.setCountry ab.User.prototype.setHomeCity ab.User.prototype.setLanguage ab.User.prototype.setEmailNotificationSubscriptionType ab.User.prototype.setPushNotificationSubscriptionType ab.User.prototype.setPhoneNumber ab.User.prototype.setAvatarImageUrl ab.User.prototype.setLastKnownLocation ab.User.prototype.setUserAttribute ab.User.prototype.setCustomUserAttribute ab.User.prototype.addToCustomAttributeArray ab.User.prototype.removeFromCustomAttributeArray ab.User.prototype.incrementCustomUserAttribute ab.User.prototype.addAlias ab.User.prototype.setCustomLocationAttribute ab.InAppMessage ab.InAppMessage.SlideFrom ab.InAppMessage.ClickAction ab.InAppMessage.DismissType ab.InAppMessage.OpenTarget ab.InAppMessage.ImageStyle ab.InAppMessage.TextAlignment ab.InAppMessage.Orientation ab.InAppMessage.CropType ab.InAppMessage.prototype.subscribeToClickedEvent ab.InAppMessage.prototype.subscribeToDismissedEvent ab.InAppMessage.prototype.removeSubscription ab.InAppMessage.prototype.removeAllSubscriptions ab.InAppMessage.prototype.closeMessage ab.InAppMessage.Button ab.InAppMessage.Button.prototype.subscribeToClickedEvent ab.InAppMessage.Button.prototype.removeSubscription ab.InAppMessage.Button.prototype.removeAllSubscriptions ab.SlideUpMessage ab.ModalMessage ab.FullScreenMessage ab.HtmlMessage ab.ControlMessage ab.Feed ab.Feed.prototype.getUnreadCardCount ab.ContentCards ab.ContentCards.prototype.getUnviewedCardCount ab.Card ab.Card.prototype.dismissCard ab.ClassicCard ab.CaptionedImage ab.Banner ab.ControlCard ab.WindowUtils display display.automaticallyShowNewInAppMessages display.showInAppMessage display.showFeed display.destroyFeed display.toggleFeed display.showContentCards display.hideContentCards display.toggleContentCards sharedLib".split(" "),s=0;s<o.length;s++){for(var a=o[s],u=e.appboy,c=a.split("."),l=0;l<c.length-1;l++)u=u[c[l]];u[c[l]]=new Function("return function "+a.replace(/\./g,"_")+"(){window.appboyQueue.push(arguments); return true}")()}window.appboy.getUser=function(){return new window.appboy.ab.User},window.appboy.getCachedFeed=function(){return new window.appboy.ab.Feed},window.appboy.getCachedContentCards=function(){return new window.appboy.ab.ContentCards},(i=t.createElement(n)).type="text/javascript",i.src="https://js.appboycdn.com/web-sdk/2.4/appboy.min.js",i.async=1,(r=t.getElementsByTagName(n)[0]).parentNode.insertBefore(i,r)}(window,document,"script"),window.appboy.initialize(this.appKey,{enableLogging:!0,baseUrl:this.endPoint}),window.appboy.display.automaticallyShowNewInAppMessages();var e=this.analytics.userId;e&&appboy.changeUser(e),window.appboy.openSession()}},{key:"handleReservedProperties",value:function(e){return["time","product_id","quantity","event_name","price","currency"].forEach((function(t){delete e[t]})),e}},{key:"identify",value:function(e){var t=e.message.userId,n=e.message.context.traits.address,r=e.message.context.traits.avatar,i=e.message.context.traits.birthday,o=e.message.context.traits.email,s=e.message.context.traits.firstname,a=e.message.context.traits.gender,u=e.message.context.traits.lastname,c=e.message.context.traits.phone,l=JSON.parse(JSON.stringify(e.message.context.traits));window.appboy.changeUser(t),window.appboy.getUser().setAvatarImageUrl(r),o&&window.appboy.getUser().setEmail(o),s&&window.appboy.getUser().setFirstName(s),a&&window.appboy.getUser().setGender(this.formatGender(a)),u&&window.appboy.getUser().setLastName(u),c&&window.appboy.getUser().setPhoneNumber(c),n&&(window.appboy.getUser().setCountry(n.country),window.appboy.getUser().setHomeCity(n.city)),i&&window.appboy.getUser().setDateOfBirth(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate());["avatar","address","birthday","email","id","firstname","gender","lastname","phone","facebook","twitter","first_name","last_name","dob","external_id","country","home_city","bio","gender","phone","email_subscribe","push_subscribe"].forEach((function(e){delete l[e]})),Object.keys(l).forEach((function(e){window.appboy.getUser().setCustomUserAttribute(e,l[e])}))}},{key:"handlePurchase",value:function(e,t){var n=e.products,r=e.currency;window.appboy.changeUser(t),del(e,"products"),del(e,"currency"),n.forEach((function(t){var n=t.product_id,i=t.price,o=t.quantity;o&&i&&n&&window.appboy.logPurchase(n,i,r,o,e)}))}},{key:"track",value:function(e){var t=e.message.userId,n=e.message.event,r=e.message.properties;window.appboy.changeUser(t),"order completed"===n.toLowerCase()?this.handlePurchase(r,t):(r=this.handleReservedProperties(r),window.appboy.logCustomEvent(n,r))}},{key:"page",value:function(e){var t=e.message.userId,n=e.message.name,r=e.message.properties;r=this.handleReservedProperties(r),window.appboy.changeUser(t),window.appboy.logCustomEvent(n,r)}},{key:"isLoaded",value:function(){return null===window.appboyQueue}},{key:"isReady",value:function(){return null===window.appboyQueue}}]),e}(),S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function j(e,t){return e(t={exports:{}},t.exports),t.exports}var R=j((function(e){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?n.push(t.charAt(i>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}};e.exports=n}()})),P={utf8:{stringToBytes:function(e){return P.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(P.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}},x=P,U=function(e){return null!=e&&(N(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&N(e.slice(0,0))}(e)||!!e._isBuffer)};function N(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var D,L,M=j((function(e){!function(){var t=R,n=x.utf8,r=U,i=x.bin,o=function(e,s){e.constructor==String?e=s&&"binary"===s.encoding?i.stringToBytes(e):n.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var a=t.bytesToWords(e),u=8*e.length,c=1732584193,l=-271733879,d=-1732584194,f=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[u>>>5]|=128<<u%32,a[14+(u+64>>>9<<4)]=u;var h=o._ff,g=o._gg,y=o._hh,m=o._ii;for(p=0;p<a.length;p+=16){var v=c,b=l,w=d,k=f;c=h(c,l,d,f,a[p+0],7,-680876936),f=h(f,c,l,d,a[p+1],12,-389564586),d=h(d,f,c,l,a[p+2],17,606105819),l=h(l,d,f,c,a[p+3],22,-1044525330),c=h(c,l,d,f,a[p+4],7,-176418897),f=h(f,c,l,d,a[p+5],12,1200080426),d=h(d,f,c,l,a[p+6],17,-1473231341),l=h(l,d,f,c,a[p+7],22,-45705983),c=h(c,l,d,f,a[p+8],7,1770035416),f=h(f,c,l,d,a[p+9],12,-1958414417),d=h(d,f,c,l,a[p+10],17,-42063),l=h(l,d,f,c,a[p+11],22,-1990404162),c=h(c,l,d,f,a[p+12],7,1804603682),f=h(f,c,l,d,a[p+13],12,-40341101),d=h(d,f,c,l,a[p+14],17,-1502002290),c=g(c,l=h(l,d,f,c,a[p+15],22,1236535329),d,f,a[p+1],5,-165796510),f=g(f,c,l,d,a[p+6],9,-1069501632),d=g(d,f,c,l,a[p+11],14,643717713),l=g(l,d,f,c,a[p+0],20,-373897302),c=g(c,l,d,f,a[p+5],5,-701558691),f=g(f,c,l,d,a[p+10],9,38016083),d=g(d,f,c,l,a[p+15],14,-660478335),l=g(l,d,f,c,a[p+4],20,-405537848),c=g(c,l,d,f,a[p+9],5,568446438),f=g(f,c,l,d,a[p+14],9,-1019803690),d=g(d,f,c,l,a[p+3],14,-187363961),l=g(l,d,f,c,a[p+8],20,1163531501),c=g(c,l,d,f,a[p+13],5,-1444681467),f=g(f,c,l,d,a[p+2],9,-51403784),d=g(d,f,c,l,a[p+7],14,1735328473),c=y(c,l=g(l,d,f,c,a[p+12],20,-1926607734),d,f,a[p+5],4,-378558),f=y(f,c,l,d,a[p+8],11,-2022574463),d=y(d,f,c,l,a[p+11],16,1839030562),l=y(l,d,f,c,a[p+14],23,-35309556),c=y(c,l,d,f,a[p+1],4,-1530992060),f=y(f,c,l,d,a[p+4],11,1272893353),d=y(d,f,c,l,a[p+7],16,-155497632),l=y(l,d,f,c,a[p+10],23,-1094730640),c=y(c,l,d,f,a[p+13],4,681279174),f=y(f,c,l,d,a[p+0],11,-358537222),d=y(d,f,c,l,a[p+3],16,-722521979),l=y(l,d,f,c,a[p+6],23,76029189),c=y(c,l,d,f,a[p+9],4,-640364487),f=y(f,c,l,d,a[p+12],11,-421815835),d=y(d,f,c,l,a[p+15],16,530742520),c=m(c,l=y(l,d,f,c,a[p+2],23,-995338651),d,f,a[p+0],6,-198630844),f=m(f,c,l,d,a[p+7],10,1126891415),d=m(d,f,c,l,a[p+14],15,-1416354905),l=m(l,d,f,c,a[p+5],21,-57434055),c=m(c,l,d,f,a[p+12],6,1700485571),f=m(f,c,l,d,a[p+3],10,-1894986606),d=m(d,f,c,l,a[p+10],15,-1051523),l=m(l,d,f,c,a[p+1],21,-2054922799),c=m(c,l,d,f,a[p+8],6,1873313359),f=m(f,c,l,d,a[p+15],10,-30611744),d=m(d,f,c,l,a[p+6],15,-1560198380),l=m(l,d,f,c,a[p+13],21,1309151649),c=m(c,l,d,f,a[p+4],6,-145523070),f=m(f,c,l,d,a[p+11],10,-1120210379),d=m(d,f,c,l,a[p+2],15,718787259),l=m(l,d,f,c,a[p+9],21,-343485551),c=c+v>>>0,l=l+b>>>0,d=d+w>>>0,f=f+k>>>0}return t.endian([c,l,d,f])};o._ff=function(e,t,n,r,i,o,s){var a=e+(t&n|~t&r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._gg=function(e,t,n,r,i,o,s){var a=e+(t&r|n&~r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._hh=function(e,t,n,r,i,o,s){var a=e+(t^n^r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._ii=function(e,t,n,r,i,o,s){var a=e+(n^(t|~r))+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,n){if(null==e)throw new Error("Illegal argument "+e);var r=t.wordsToBytes(o(e,n));return n&&n.asBytes?r:n&&n.asString?i.bytesToString(r):t.bytesToHex(r)}}()})),B=function(){function e(t){n(this,e),this.NAME="INTERCOM",this.API_KEY=t.apiKey,this.APP_ID=t.appId,this.MOBILE_APP_ID=t.mobileAppId,l.debug("Config ",t)}return i(e,[{key:"init",value:function(){window.intercomSettings={app_id:this.APP_ID},function(){var e=window,t=e.Intercom;if("function"==typeof t)t("reattach_activator"),t("update",e.intercomSettings);else{var n=document,r=function e(){e.c(arguments)};r.q=[],r.c=function(e){r.q.push(e)},e.Intercom=r;var i=function(){var e=n.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://widget.intercom.io/widget/"+window.intercomSettings.app_id;var t=n.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)};"complete"===document.readyState?(i(),window.intercom_code=!0):e.attachEvent?(e.attachEvent("onload",i),window.intercom_code=!0):(e.addEventListener("load",i,!1),window.intercom_code=!0)}}()}},{key:"page",value:function(){window.Intercom("update")}},{key:"identify",value:function(e){var n={},r=e.message.context;if(null!=(r.Intercom?r.Intercom:null)){var i=r.Intercom.user_hash?r.Intercom.user_hash:null;null!=i&&(n.user_hash=i);var o=r.Intercom.hideDefaultLauncher?r.Intercom.hideDefaultLauncher:null;null!=o&&(n.hide_default_launcher=o)}Object.keys(r.traits).forEach((function(e){if(r.traits.hasOwnProperty(e)){var i=r.traits[e];if("company"===e){var o=[],s={};"string"==typeof r.traits[e]&&(s.company_id=M(r.traits[e]));var a="object"==t(r.traits[e])&&Object.keys(r.traits[e])||[];a.forEach((function(t){a.hasOwnProperty(t)&&("id"!=t?s[t]=r.traits[e][t]:s.company_id=r.traits[e][t])})),"object"!=t(r.traits[e])||a.includes("id")||(s.company_id=M(s.name)),o.push(s),n.companies=o}else n[e]=r.traits[e];switch(e){case"createdAt":n.created_at=i;break;case"anonymousId":n.user_id=i}}})),n.user_id=e.message.userId,window.Intercom("update",n)}},{key:"track",value:function(e){var t={},n=e.message;(n.properties?Object.keys(n.properties):null).forEach((function(e){var r=n.properties[e];t[e]=r})),n.event&&(t.event_name=n.event),t.user_id=n.userId?n.userId:n.anonymousId,t.created_at=Math.floor(new Date(n.originalTimestamp).getTime()/1e3),window.Intercom("trackEvent",t.event_name,t)}},{key:"isLoaded",value:function(){return!!window.intercom_code}},{key:"isReady",value:function(){return!!window.intercom_code}}]),e}(),F=function(){function e(t){n(this,e),this.projectID=t.projectID,this.writeKey=t.writeKey,this.ipAddon=t.ipAddon,this.uaAddon=t.uaAddon,this.urlAddon=t.urlAddon,this.referrerAddon=t.referrerAddon,this.client=null,this.name="KEEN"}return i(e,[{key:"init",value:function(){l.debug("===in init Keen==="),k("keen-integration","https://cdn.jsdelivr.net/npm/keen-tracking@4");var e=setInterval(function(){void 0!==window.KeenTracking&&void 0!==window.KeenTracking&&(this.client=function(e){return e.client=new window.KeenTracking({projectId:e.projectID,writeKey:e.writeKey}),e.client}(this),clearInterval(e))}.bind(this),1e3)}},{key:"identify",value:function(e){l.debug("in Keen identify");var t=e.message.context.traits,n=e.message.userId?e.message.userId:e.message.anonymousId,r=e.message.properties?Object.assign(r,e.message.properties):{};r.user={userId:n,traits:t},r=this.getAddOn(r),this.client.extendEvents(r)}},{key:"track",value:function(e){l.debug("in Keen track");var t=e.message.event,n=e.message.properties;n=this.getAddOn(n),this.client.recordEvent(t,n)}},{key:"page",value:function(e){l.debug("in Keen page");var t=e.message.name,n=e.message.properties?e.message.properties.category:void 0,r="Loaded a Page";t&&(r="Viewed "+t+" page"),n&&t&&(r="Viewed "+n+" "+t+" page");var i=e.message.properties;i=this.getAddOn(i),this.client.recordEvent(r,i)}},{key:"isLoaded",value:function(){return l.debug("in Keen isLoaded"),!(null==this.client)}},{key:"isReady",value:function(){return!(null==this.client)}},{key:"getAddOn",value:function(e){var t=[];return this.ipAddon&&(e.ip_address="${keen.ip}",t.push({name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_geo_info"})),this.uaAddon&&(e.user_agent="${keen.user_agent}",t.push({name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"parsed_user_agent"})),this.urlAddon&&(e.page_url=document.location.href,t.push({name:"keen:url_parser",input:{url:"page_url"},output:"parsed_page_url"})),this.referrerAddon&&(e.page_url=document.location.href,e.referrer_url=document.referrer,t.push({name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_info"})),e.keen={addons:t},e}}]),e}(),K=Object.prototype,q=K.hasOwnProperty,G=K.toString;"function"==typeof Symbol&&(D=Symbol.prototype.valueOf),"function"==typeof BigInt&&(L=BigInt.prototype.valueOf);var H=function(e){return e!=e},V={boolean:1,number:1,string:1,undefined:1},z=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/,J=/^[A-Fa-f0-9]+$/,W={};W.a=W.type=function(e,t){return typeof e===t},W.defined=function(e){return void 0!==e},W.empty=function(e){var t,n=G.call(e);if("[object Array]"===n||"[object Arguments]"===n||"[object String]"===n)return 0===e.length;if("[object Object]"===n){for(t in e)if(q.call(e,t))return!1;return!0}return!e},W.equal=function(e,t){if(e===t)return!0;var n,r=G.call(e);if(r!==G.call(t))return!1;if("[object Object]"===r){for(n in e)if(!(W.equal(e[n],t[n])&&n in t))return!1;for(n in t)if(!(W.equal(e[n],t[n])&&n in e))return!1;return!0}if("[object Array]"===r){if((n=e.length)!==t.length)return!1;for(;n--;)if(!W.equal(e[n],t[n]))return!1;return!0}return"[object Function]"===r?e.prototype===t.prototype:"[object Date]"===r&&e.getTime()===t.getTime()},W.hosted=function(e,t){var n=typeof t[e];return"object"===n?!!t[e]:!V[n]},W.instance=W.instanceof=function(e,t){return e instanceof t},W.nil=W.null=function(e){return null===e},W.undef=W.undefined=function(e){return void 0===e},W.args=W.arguments=function(e){var t="[object Arguments]"===G.call(e),n=!W.array(e)&&W.arraylike(e)&&W.object(e)&&W.fn(e.callee);return t||n},W.array=Array.isArray||function(e){return"[object Array]"===G.call(e)},W.args.empty=function(e){return W.args(e)&&0===e.length},W.array.empty=function(e){return W.array(e)&&0===e.length},W.arraylike=function(e){return!!e&&!W.bool(e)&&q.call(e,"length")&&isFinite(e.length)&&W.number(e.length)&&e.length>=0},W.bool=W.boolean=function(e){return"[object Boolean]"===G.call(e)},W.false=function(e){return W.bool(e)&&!1===Boolean(Number(e))},W.true=function(e){return W.bool(e)&&!0===Boolean(Number(e))},W.date=function(e){return"[object Date]"===G.call(e)},W.date.valid=function(e){return W.date(e)&&!isNaN(Number(e))},W.element=function(e){return void 0!==e&&"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&1===e.nodeType},W.error=function(e){return"[object Error]"===G.call(e)},W.fn=W.function=function(e){if("undefined"!=typeof window&&e===window.alert)return!0;var t=G.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t||"[object AsyncFunction]"===t},W.number=function(e){return"[object Number]"===G.call(e)},W.infinite=function(e){return e===1/0||e===-1/0},W.decimal=function(e){return W.number(e)&&!H(e)&&!W.infinite(e)&&e%1!=0},W.divisibleBy=function(e,t){var n=W.infinite(e),r=W.infinite(t),i=W.number(e)&&!H(e)&&W.number(t)&&!H(t)&&0!==t;return n||r||i&&e%t==0},W.integer=W.int=function(e){return W.number(e)&&!H(e)&&e%1==0},W.maximum=function(e,t){if(H(e))throw new TypeError("NaN is not a valid value");if(!W.arraylike(t))throw new TypeError("second argument must be array-like");for(var n=t.length;--n>=0;)if(e<t[n])return!1;return!0},W.minimum=function(e,t){if(H(e))throw new TypeError("NaN is not a valid value");if(!W.arraylike(t))throw new TypeError("second argument must be array-like");for(var n=t.length;--n>=0;)if(e>t[n])return!1;return!0},W.nan=function(e){return!W.number(e)||e!=e},W.even=function(e){return W.infinite(e)||W.number(e)&&e==e&&e%2==0},W.odd=function(e){return W.infinite(e)||W.number(e)&&e==e&&e%2!=0},W.ge=function(e,t){if(H(e)||H(t))throw new TypeError("NaN is not a valid value");return!W.infinite(e)&&!W.infinite(t)&&e>=t},W.gt=function(e,t){if(H(e)||H(t))throw new TypeError("NaN is not a valid value");return!W.infinite(e)&&!W.infinite(t)&&e>t},W.le=function(e,t){if(H(e)||H(t))throw new TypeError("NaN is not a valid value");return!W.infinite(e)&&!W.infinite(t)&&e<=t},W.lt=function(e,t){if(H(e)||H(t))throw new TypeError("NaN is not a valid value");return!W.infinite(e)&&!W.infinite(t)&&e<t},W.within=function(e,t,n){if(H(e)||H(t)||H(n))throw new TypeError("NaN is not a valid value");if(!W.number(e)||!W.number(t)||!W.number(n))throw new TypeError("all arguments must be numbers");return W.infinite(e)||W.infinite(t)||W.infinite(n)||e>=t&&e<=n},W.object=function(e){return"[object Object]"===G.call(e)},W.primitive=function(e){return!e||!("object"==typeof e||W.object(e)||W.fn(e)||W.array(e))},W.hash=function(e){return W.object(e)&&e.constructor===Object&&!e.nodeType&&!e.setInterval},W.regexp=function(e){return"[object RegExp]"===G.call(e)},W.string=function(e){return"[object String]"===G.call(e)},W.base64=function(e){return W.string(e)&&(!e.length||z.test(e))},W.hex=function(e){return W.string(e)&&(!e.length||J.test(e))},W.symbol=function(e){return"function"==typeof Symbol&&"[object Symbol]"===G.call(e)&&"symbol"==typeof D.call(e)},W.bigint=function(e){return"function"==typeof BigInt&&"[object BigInt]"===G.call(e)&&"bigint"==typeof L.call(e)};var Y,$=W,Q=Object.prototype.hasOwnProperty,Z=function(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n+=1)for(var r in t[n])Q.call(t[n],r)&&(e[r]=t[n][r]);return e},X=j((function(e){function t(e){return function(t,n,r,o){var s;normalize=o&&function(e){return"function"==typeof e}(o.normalizer)?o.normalizer:i,n=normalize(n);for(var a=!1;!a;)u();function u(){for(s in t){var e=normalize(s);if(0===n.indexOf(e)){var r=n.substr(e.length);if("."===r.charAt(0)||0===r.length){n=r.substr(1);var i=t[s];return null==i?void(a=!0):n.length?void(t=i):void(a=!0)}}}s=void 0,a=!0}if(s)return null==t?t:e(t,s,r)}}function n(e,t){return e.hasOwnProperty(t)&&delete e[t],e}function r(e,t,n){return e.hasOwnProperty(t)&&(e[t]=n),e}function i(e){return e.replace(/[^a-zA-Z0-9\.]+/g,"").toLowerCase()}e.exports=t((function(e,t){if(e.hasOwnProperty(t))return e[t]})),e.exports.find=e.exports,e.exports.replace=function(e,n,i,o){return t(r).call(this,e,n,i,o),e},e.exports.del=function(e,r,i){return t(n).call(this,e,r,null,i),e}})),ee=(X.find,X.replace,X.del,Object.prototype.toString),te=function(e){switch(ee.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}return null===e?"null":void 0===e?"undefined":e&&1===e.nodeType?"element":e===Object(e)?"object":typeof e},ne=/\b(Array|Date|Object|Math|JSON)\b/g,re=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length;n++)~t.indexOf(e[n])||t.push(e[n]);return t}(function(e){return e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(ne,"").match(/[a-zA-Z_]\w*/g)||[]}(e));return t&&"string"==typeof t&&(t=function(e){return function(t){return e+t}}(t)),t?function(e,t,n){return e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g,(function(e){return"("==e[e.length-1]?n(e):~t.indexOf(e)?n(e):e}))}(e,n,t):n};try{Y=re}catch(e){Y=re}var ie=oe;function oe(e){switch({}.toString.call(e)){case"[object Object]":return function(e){var t={};for(var n in e)t[n]="string"==typeof e[n]?se(e[n]):oe(e[n]);return function(e){if("object"!=typeof e)return!1;for(var n in t){if(!(n in e))return!1;if(!t[n](e[n]))return!1}return!0}}(e);case"[object Function]":return e;case"[object String]":return/^ *\W+/.test(n=e)?new Function("_","return _ "+n):new Function("_","return "+function(e){var t,n,r,i=Y(e);if(!i.length)return"_."+e;for(n=0;n<i.length;n++)r=i[n],e=ae(r,e,t="('function' == typeof "+(t="_."+r)+" ? "+t+"() : "+t+")");return e}(n));case"[object RegExp]":return t=e,function(e){return t.test(e)};default:return se(e)}var t,n}function se(e){return function(t){return e===t}}function ae(e,t,n){return t.replace(new RegExp("(\\.)?"+e,"g"),(function(e,t){return t?e:n}))}try{var ue=te}catch(e){ue=te}var ce=Object.prototype.hasOwnProperty,le=function(e,t,n){switch(t=ie(t),n=n||this,ue(e)){case"array":return de(e,t,n);case"object":return"number"==typeof e.length?de(e,t,n):function(e,t,n){for(var r in e)ce.call(e,r)&&t.call(n,r,e[r])}(e,t,n);case"string":return function(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e.charAt(r),r)}(e,t,n)}};function de(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e[r],r)}var fe=function(){function e(t){n(this,e),this.apiKey=t.apiKey,this.prefixProperties=t.prefixProperties,this.name="KISSMETRICS"}return i(e,[{key:"init",value:function(){l.debug("===in init Kissmetrics==="),window._kmq=window._kmq||[];var e=window._kmk||this.apiKey;function t(e){setTimeout((function(){var t=document,n=t.getElementsByTagName("script")[0],r=t.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,n.parentNode.insertBefore(r,n)}),1)}t("//i.kissmetrics.com/i.js"),t("//scripts.kissmetrics.com/"+e+".2.js"),this.isEnvMobile()&&window._kmq.push(["set",{"Mobile Session":"Yes"}])}},{key:"isEnvMobile",value:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/Opera Mini/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone|iPod/i)}},{key:"toUnixTimestamp",value:function(e){return e=new Date(e),Math.floor(e.getTime()/1e3)}},{key:"clean",value:function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(null==r)continue;if($.date(r)){t[n]=this.toUnixTimestamp(r);continue}if($.bool(r)){t[n]=r;continue}if($.number(r)){t[n]=r;continue}if(l.debug(r.toString()),"[object Object]"!==r.toString()){t[n]=r.toString();continue}var i={};i[n]=r;var o=this.flatten(i,{safe:!0});for(var s in o)$.array(o[s])&&(o[s]=o[s].toString());delete(t=Z(t,o))[n]}return t}},{key:"flatten",value:function(e,t){var n=(t=t||{}).delimiter||".",r=t.maxDepth,i=1,o={};return function e(s,a){for(var u in s)if(s.hasOwnProperty(u)){var c=s[u],l=t.safe&&$.array(c),d=Object.prototype.toString.call(c),f="[object Object]"===d||"[object Array]"===d,p=[],h=a?a+n+u:u;for(var g in t.maxDepth||(r=i+1),c)c.hasOwnProperty(g)&&p.push(g);if(!l&&f&&p.length&&i<r)return++i,e(c,h);o[h]=c}}(e),o}},{key:"prefix",value:function(e,t){var n={};return le(t,(function(t,r){"Billing Amount"===t?n[t]=r:"revenue"===t?(n[e+" - "+t]=r,n["Billing Amount"]=r):n[e+" - "+t]=r})),n}},{key:"identify",value:function(e){l.debug("in Kissmetrics identify");var t=this.clean(e.message.context.traits),n=e.message.userId&&""!=e.message.userId?e.message.userId:void 0;n&&window._kmq.push(["identify",n]),t&&window._kmq.push(["set",t])}},{key:"track",value:function(e){l.debug("in Kissmetrics track");var t=e.message.event,n=JSON.parse(JSON.stringify(e.message.properties)),r=this.toUnixTimestamp(new Date),i=m(n);i&&(n.revenue=i);var o=n.products;o&&delete n.products,n=this.clean(n),l.debug(JSON.stringify(n)),this.prefixProperties&&(n=this.prefix(t,n)),window._kmq.push(["record",t,n]);var s=function(e,n){var i=e;this.prefixProperties&&(i=this.prefix(t,i)),i._t=r+n,i._d=1,window.KM.set(i)}.bind(this);o&&window._kmq.push((function(){le(o,s)}))}},{key:"page",value:function(e){l.debug("in Kissmetrics page");var t=e.message.name,n=e.message.properties?e.message.properties.category:void 0,r="Loaded a Page";t&&(r="Viewed "+t+" page"),n&&t&&(r="Viewed "+n+" "+t+" page");var i=e.message.properties;this.prefixProperties&&(i=this.prefix("Page",i)),window._kmq.push(["record",r,i])}},{key:"alias",value:function(e){var t=e.message.previousId,n=e.message.userId;window._kmq.push(["alias",n,t])}},{key:"group",value:function(e){var t=e.message.groupId,n=e.message.traits;n=this.prefix("Group",n),t&&(n["Group - id"]=t),window._kmq.push(["set",n]),l.debug("in Kissmetrics group")}},{key:"isLoaded",value:function(){return $.object(window.KM)}},{key:"isReady",value:function(){return $.object(window.KM)}}]),e}(),pe=function(){function e(t){n(this,e),this.siteID=t.siteID,this.apiKey=t.apiKey,this.name="CUSTOMERIO"}return i(e,[{key:"init",value:function(){l.debug("===in init Customer IO init==="),window._cio=window._cio||[];var e=this.siteID;!function(){var t,n,r;for(t=function(e){return function(){window._cio.push([e].concat(Array.prototype.slice.call(arguments,0)))}},n=["load","identify","sidentify","track","page"],r=0;r<n.length;r++)window._cio[n[r]]=t(n[r]);var i=document.createElement("script"),o=document.getElementsByTagName("script")[0];i.async=!0,i.id="cio-tracker",i.setAttribute("data-site-id",e),i.src="https://assets.customer.io/assets/track.js",o.parentNode.insertBefore(i,o)}()}},{key:"identify",value:function(e){l.debug("in Customer IO identify");var t=e.message.userId?e.message.userId:e.message.anonymousId,n=e.message.context.traits?e.message.context.traits:{};n.created_at||(n.created_at=Math.floor((new Date).getTime()/1e3)),n.id=t,window._cio.identify(n)}},{key:"track",value:function(e){l.debug("in Customer IO track");var t=e.message.event,n=e.message.properties;window._cio.track(t,n)}},{key:"page",value:function(e){l.debug("in Customer IO page");var t=e.message.name||e.message.properties.url;window._cio.page(t,e.message.properties)}},{key:"isLoaded",value:function(){return!(!window._cio||window._cio.push===Array.prototype.push)}},{key:"isReady",value:function(){return!(!window._cio||window._cio.push===Array.prototype.push)}}]),e}(),he=Object.prototype.toString,ge=function(e){switch(he.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}return null===e?"null":void 0===e?"undefined":e&&1===e.nodeType?"element":e===Object(e)?"object":typeof e};try{var ye=ge}catch(e){ye=ge}var me=Object.prototype.hasOwnProperty,ve=function(e,t,n){switch(t=ie(t),n=n||this,ye(e)){case"array":return be(e,t,n);case"object":return"number"==typeof e.length?be(e,t,n):function(e,t,n){for(var r in e)me.call(e,r)&&t.call(n,r,e[r])}(e,t,n);case"string":return function(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e.charAt(r),r)}(e,t,n)}};function be(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e[r],r)}var we=!1,ke=[],_e=setInterval((function(){document.body&&(we=!0,ve(ke,Ee),clearInterval(_e))}),5);function Ee(e){e(document.body)}var Ie=function(){function e(t,r){n(this,e),this.analytics=r,this._sf_async_config=window._sf_async_config=window._sf_async_config||{},window._sf_async_config.useCanonical=!0,window._sf_async_config.uid=t.uid,window._sf_async_config.domain=t.domain,this.isVideo=!!t.video,this.sendNameAndCategoryAsTitle=t.sendNameAndCategoryAsTitle||!0,this.subscriberEngagementKeys=t.subscriberEngagementKeys||[],this.replayEvents=[],this.failed=!1,this.isFirstPageCallMade=!1,this.name="Chartbeat"}return i(e,[{key:"init",value:function(){l.debug("===in init Chartbeat===")}},{key:"identify",value:function(e){l.debug("in Chartbeat identify")}},{key:"track",value:function(e){l.debug("in Chartbeat track")}},{key:"page",value:function(e){if(l.debug("in Chartbeat page"),this.loadConfig(e),this.isFirstPageCallMade){if(this.failed)return l.debug("===ignoring cause failed integration==="),void(this.replayEvents=[]);if(!this.isLoaded()&&!this.failed)return l.debug("===pushing to replay queue for chartbeat==="),void this.replayEvents.push(["page",e]);l.debug("===processing page event in chartbeat===");var t=e.message.properties;window.pSUPERFLY.virtualPage(t.path)}else this.isFirstPageCallMade=!0,this.initAfterPage()}},{key:"isLoaded",value:function(){return l.debug("in Chartbeat isLoaded"),!this.isFirstPageCallMade||!!window.pSUPERFLY}},{key:"isFailed",value:function(){return this.failed}},{key:"isReady",value:function(){return!!window.pSUPERFLY}},{key:"loadConfig",value:function(e){var t,n=e.message.properties,r=n?n.category:void 0,i=e.message.name,o=n?n.author:void 0;this.sendNameAndCategoryAsTitle&&(t=r&&i?r+" "+i:i),r&&(window._sf_async_config.sections=r),o&&(window._sf_async_config.authors=o),t&&(window._sf_async_config.title=t);var s=window._cbq=window._cbq||[];for(var a in n)n.hasOwnProperty(a)&&this.subscriberEngagementKeys.indexOf(a)>-1&&s.push([a,n[a]])}},{key:"initAfterPage",value:function(){var e,t=this;e=function(){var e,n,r=t.isVideo?"chartbeat_video.js":"chartbeat.js";e=document.createElement("script"),n=document.getElementsByTagName("script")[0],e.type="text/javascript",e.async=!0,e.src="//static.chartbeat.com/js/"+r,n.parentNode.insertBefore(e,n)},we?Ee(e):ke.push(e),this._isReady(this).then((function(e){l.debug("===replaying on chartbeat==="),e.replayEvents.forEach((function(t){e[t[0]](t[1])}))}))}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"_isReady",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return t.isLoaded()?(t.failed=!1,l.debug("===chartbeat loaded successfully==="),e.analytics.emit("ready"),r(e)):n>=1e4?(t.failed=!0,l.debug("===chartbeat failed==="),r(e)):void t.pause(1e3).then((function(){return t._isReady(e,n+1e3).then(r)}))}))}}]),e}(),Ae=function(){function e(t,r){n(this,e),this.c2ID=t.c2ID,this.analytics=r,this.comScoreBeaconParam=t.comScoreBeaconParam?t.comScoreBeaconParam:{},this.isFirstPageCallMade=!1,this.failed=!1,this.comScoreParams={},this.replayEvents=[],this.name="COMSCORE"}return i(e,[{key:"init",value:function(){l.debug("===in init Comscore init===")}},{key:"identify",value:function(e){l.debug("in Comscore identify")}},{key:"track",value:function(e){l.debug("in Comscore track")}},{key:"page",value:function(e){if(l.debug("in Comscore page"),this.loadConfig(e),this.isFirstPageCallMade){if(this.failed)return void(this.replayEvents=[]);if(!this.isLoaded()&&!this.failed)return void this.replayEvents.push(["page",e]);e.message.properties;window.COMSCORE.beacon(this.comScoreParams)}else this.isFirstPageCallMade=!0,this.initAfterPage()}},{key:"loadConfig",value:function(e){l.debug("=====in loadConfig====="),this.comScoreParams=this.mapComscoreParams(e.message.properties),window._comscore=window._comscore||[],window._comscore.push(this.comScoreParams)}},{key:"initAfterPage",value:function(){l.debug("=====in initAfterPage====="),function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.async=!0,e.src=("https:"==document.location.protocol?"https://sb":"http://b")+".scorecardresearch.com/beacon.js",t.parentNode.insertBefore(e,t)}(),this._isReady(this).then((function(e){e.replayEvents.forEach((function(t){e[t[0]](t[1])}))}))}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"_isReady",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return t.isLoaded()?(t.failed=!1,e.analytics.emit("ready"),r(e)):n>=1e4?(t.failed=!0,r(e)):void t.pause(1e3).then((function(){return t._isReady(e,n+1e3).then(r)}))}))}},{key:"mapComscoreParams",value:function(e){l.debug("=====in mapComscoreParams=====");var t=this.comScoreBeaconParam,n={};return Object.keys(t).forEach((function(r){if(r in e){var i=t[r],o=e[r];n[i]=o}})),n.c1="2",n.c2=this.c2ID,l.debug("=====in mapComscoreParams=====",n),n}},{key:"isLoaded",value:function(){return l.debug("in Comscore isLoaded"),!this.isFirstPageCallMade||!!window.COMSCORE}},{key:"isReady",value:function(){return!!window.COMSCORE}}]),e}(),Te=Object.prototype.toString;var Ce=function e(t){var n=function(e){switch(Te.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!=e?"nan":e&&1===e.nodeType?"element":null!=(t=e)&&(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))?"buffer":typeof(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e));var t}(t);if("object"===n){var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=e(t[i]));return r}if("array"===n){r=new Array(t.length);for(var o=0,s=t.length;o<s;o++)r[o]=e(t[o]);return r}if("regexp"===n){var a="";return a+=t.multiline?"m":"",a+=t.global?"g":"",a+=t.ignoreCase?"i":"",new RegExp(t.source,a)}return"date"===n?new Date(t.getTime()):t},Oe=1e3,Se=60*Oe,je=60*Se,Re=24*je,Pe=365.25*Re,xe=function(e,t){return t=t||{},"string"==typeof e?function(e){if((e=""+e).length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*Pe;case"days":case"day":case"d":return n*Re;case"hours":case"hour":case"hrs":case"hr":case"h":return n*je;case"minutes":case"minute":case"mins":case"min":case"m":return n*Se;case"seconds":case"second":case"secs":case"sec":case"s":return n*Oe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}(e):t.long?function(e){return Ue(e,Re,"day")||Ue(e,je,"hour")||Ue(e,Se,"minute")||Ue(e,Oe,"second")||e+" ms"}(e):function(e){return e>=Re?Math.round(e/Re)+"d":e>=je?Math.round(e/je)+"h":e>=Se?Math.round(e/Se)+"m":e>=Oe?Math.round(e/Oe)+"s":e+"ms"}(e)};function Ue(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var Ne=j((function(e,t){(t=e.exports=function(e){function i(){}function o(){var e=o,i=+new Date,s=i-(n||i);e.diff=s,e.prev=n,e.curr=i,n=i,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=t.colors[r++%t.colors.length]);var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var u=0;a[0]=a[0].replace(/%([a-z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n})),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a)),(o.log||t.log||console.log.bind(console)).apply(e,a)}i.enabled=!1,o.enabled=!0;var s=t.enabled(e)?o:i;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=xe,t.names=[],t.skips=[],t.formatters={};var n,r=0})),De=(Ne.coerce,Ne.disable,Ne.enable,Ne.enabled,Ne.humanize,Ne.names,Ne.skips,Ne.formatters,j((function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=Ne).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())}))),Le=(De.log,De.formatArgs,De.save,De.load,De.useColors,De.storage,De.colors,De("cookie")),Me=function(e,t,n){switch(arguments.length){case 3:case 2:return Be(e,t,n);case 1:return Ke(e);default:return Fe()}};function Be(e,t,n){n=n||{};var r=qe(e)+"="+qe(t);null==t&&(n.maxage=-1),n.maxage&&(n.expires=new Date(+new Date+n.maxage)),n.path&&(r+="; path="+n.path),n.domain&&(r+="; domain="+n.domain),n.expires&&(r+="; expires="+n.expires.toUTCString()),n.secure&&(r+="; secure"),document.cookie=r}function Fe(){var e;try{e=document.cookie}catch(e){return"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e.stack||e),{}}return function(e){var t,n={},r=e.split(/ *; */);if(""==r[0])return n;for(var i=0;i<r.length;++i)t=r[i].split("="),n[Ge(t[0])]=Ge(t[1]);return n}(e)}function Ke(e){return Fe()[e]}function qe(e){try{return encodeURIComponent(e)}catch(t){Le("error `encode(%o)` - %o",e,t)}}function Ge(e){try{return decodeURIComponent(e)}catch(t){Le("error `decode(%o)` - %o",e,t)}}var He=Math.max,Ve=function(e,t){var n=t?t.length:0;if(!n)return[];for(var r=He(Number(e)||0,0),i=He(n-r,0),o=new Array(i),s=0;s<i;s+=1)o[s]=t[s+r];return o},ze=Math.max,Je=function(e){if(null==e||!e.length)return[];for(var t=new Array(ze(e.length-2,0)),n=1;n<e.length;n+=1)t[n-1]=e[n];return t},We=Object.prototype.hasOwnProperty,Ye=Object.prototype.toString,$e=function(e){return Boolean(e)&&"object"==typeof e},Qe=function(e){return Boolean(e)&&"[object Object]"===Ye.call(e)},Ze=function(e,t,n,r){return We.call(t,r)&&void 0===e[r]&&(e[r]=n),t},Xe=function(e,t,n,r){return We.call(t,r)&&(Qe(e[r])&&Qe(n)?e[r]=tt(e[r],n):void 0===e[r]&&(e[r]=n)),t},et=function(e,t){if(!$e(t))return t;e=e||Ze;for(var n=Ve(2,arguments),r=0;r<n.length;r+=1)for(var i in n[r])e(t,n[r],n[r][i],i);return t},tt=function(e){return et.apply(null,[Xe,e].concat(Je(arguments)))},nt=function(e){return et.apply(null,[null,e].concat(Je(arguments)))},rt=tt;nt.deep=rt;for(var it=j((function(e,t){(function(){var n={function:!0,object:!0},r=t&&!t.nodeType&&t,i=n[typeof window]&&window||this,o=r&&n.object&&e&&!e.nodeType&&"object"==typeof S&&S;function s(e,t){e||(e=i.Object()),t||(t=i.Object());var r=e.Number||i.Number,o=e.String||i.String,a=e.Object||i.Object,u=e.Date||i.Date,c=e.SyntaxError||i.SyntaxError,l=e.TypeError||i.TypeError,d=e.Math||i.Math,f=e.JSON||i.JSON;"object"==typeof f&&f&&(t.stringify=f.stringify,t.parse=f.parse);var p,h=a.prototype,g=h.toString,y=h.hasOwnProperty;function m(e,t){try{e()}catch(e){t&&t()}}var v=new u(-0xc782b5b800cec);function b(e){if(null!=b[e])return b[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=b("json-stringify")&&b("date-serialization")&&b("json-parse");else if("date-serialization"==e){if(n=b("json-stringify")&&v){var i=t.stringify;m((function(){n='"-271821-04-20T00:00:00.000Z"'==i(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new u(-1))}))}}else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var c="function"==typeof(i=t.stringify);c&&((s=function(){return 1}).toJSON=s,m((function(){c="0"===i(0)&&"0"===i(new r)&&'""'==i(new o)&&i(g)===p&&i(p)===p&&i()===p&&"1"===i(s)&&"[1]"==i([s])&&"[null]"==i([p])&&"null"==i(null)&&"[null,null,null]"==i([p,g,null])&&i({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===i(null,s)&&"[\n 1,\n 2\n]"==i([1,2],null,1)}),(function(){c=!1}))),n=c}if("json-parse"==e){var l,d=t.parse;"function"==typeof d&&m((function(){0!==d("0")||d(!1)||(s=d(a),(l=5==s.a.length&&1===s.a[0])&&(m((function(){l=!d('"\t"')})),l&&m((function(){l=1!==d("01")})),l&&m((function(){l=1!==d("1.")}))))}),(function(){l=!1})),n=l}}return b[e]=!!n}if(m((function(){v=-109252==v.getUTCFullYear()&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()})),b["bug-string-char-index"]=b["date-serialization"]=b.json=b["json-stringify"]=b["json-parse"]=null,!b("json")){var w=b("bug-string-char-index"),k=function(e,t){var r,i,o,s=0;for(o in(r=function(){this.valueOf=0}).prototype.valueOf=0,i=new r)y.call(i,o)&&s++;return r=i=null,s?k=function(e,t){var n,r,i="[object Function]"==g.call(e);for(n in e)i&&"prototype"==n||!y.call(e,n)||(r="constructor"===n)||t(n);(r||y.call(e,n="constructor"))&&t(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],k=function(e,t){var r,o,s="[object Function]"==g.call(e),a=!s&&"function"!=typeof e.constructor&&n[typeof e.hasOwnProperty]&&e.hasOwnProperty||y;for(r in e)s&&"prototype"==r||!a.call(e,r)||t(r);for(o=i.length;r=i[--o];)a.call(e,r)&&t(r)}),k(e,t)};if(!b("json-stringify")&&!b("date-serialization")){var _={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},E=function(e,t){return("000000"+(t||0)).slice(-e)},I=function(e){var t,n,r,i,o,s,a,u,c;if(v)t=function(e){n=e.getUTCFullYear(),r=e.getUTCMonth(),i=e.getUTCDate(),s=e.getUTCHours(),a=e.getUTCMinutes(),u=e.getUTCSeconds(),c=e.getUTCMilliseconds()};else{var l=d.floor,f=[0,31,59,90,120,151,181,212,243,273,304,334],p=function(e,t){return f[t]+365*(e-1970)+l((e-1969+(t=+(t>1)))/4)-l((e-1901+t)/100)+l((e-1601+t)/400)};t=function(e){for(i=l(e/864e5),n=l(i/365.2425)+1970-1;p(n+1,0)<=i;n++);for(r=l((i-p(n,0))/30.42);p(n,r+1)<=i;r++);i=1+i-p(n,r),s=l((o=(e%864e5+864e5)%864e5)/36e5)%24,a=l(o/6e4)%60,u=l(o/1e3)%60,c=o%1e3}}return(I=function(e){return e>-1/0&&e<1/0?(t(e),e=(n<=0||n>=1e4?(n<0?"-":"+")+E(6,n<0?-n:n):E(4,n))+"-"+E(2,r+1)+"-"+E(2,i)+"T"+E(2,s)+":"+E(2,a)+":"+E(2,u)+"."+E(3,c)+"Z",n=r=i=s=a=u=c=null):e=null,e})(e)};if(b("json-stringify")&&!b("date-serialization")){function A(e){return I(this)}var T=t.stringify;t.stringify=function(e,t,n){var r=u.prototype.toJSON;u.prototype.toJSON=A;var i=T(e,t,n);return u.prototype.toJSON=r,i}}else{var C=function(e){var t=e.charCodeAt(0),n=_[t];return n||"\\u00"+E(2,t.toString(16))},O=/[\x00-\x1f\x22\x5c]/g,S=function(e){return O.lastIndex=0,'"'+(O.test(e)?e.replace(O,C):e)+'"'},j=function(e,t,n,r,i,o,s){var a,c,d,f,h,y,v,b,w;if(m((function(){a=t[e]})),"object"==typeof a&&a&&(a.getUTCFullYear&&"[object Date]"==g.call(a)&&a.toJSON===u.prototype.toJSON?a=I(a):"function"==typeof a.toJSON&&(a=a.toJSON(e))),n&&(a=n.call(t,e,a)),a==p)return a===p?a:"null";switch("object"==(c=typeof a)&&(d=g.call(a)),d||c){case"boolean":case"[object Boolean]":return""+a;case"number":case"[object Number]":return a>-1/0&&a<1/0?""+a:"null";case"string":case"[object String]":return S(""+a)}if("object"==typeof a){for(v=s.length;v--;)if(s[v]===a)throw l();if(s.push(a),f=[],b=o,o+=i,"[object Array]"==d){for(y=0,v=a.length;y<v;y++)h=j(y,a,n,r,i,o,s),f.push(h===p?"null":h);w=f.length?i?"[\n"+o+f.join(",\n"+o)+"\n"+b+"]":"["+f.join(",")+"]":"[]"}else k(r||a,(function(e){var t=j(e,a,n,r,i,o,s);t!==p&&f.push(S(e)+":"+(i?" ":"")+t)})),w=f.length?i?"{\n"+o+f.join(",\n"+o)+"\n"+b+"}":"{"+f.join(",")+"}":"{}";return s.pop(),w}};t.stringify=function(e,t,r){var i,o,s,a;if(n[typeof t]&&t)if("[object Function]"==(a=g.call(t)))o=t;else if("[object Array]"==a){s={};for(var u,c=0,l=t.length;c<l;)u=t[c++],"[object String]"!=(a=g.call(u))&&"[object Number]"!=a||(s[u]=1)}if(r)if("[object Number]"==(a=g.call(r))){if((r-=r%1)>0)for(r>10&&(r=10),i="";i.length<r;)i+=" "}else"[object String]"==a&&(i=r.length<=10?r:r.slice(0,10));return j("",((u={})[""]=e,u),o,s,i,"",[])}}}if(!b("json-parse")){var R,P,x=o.fromCharCode,U={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},N=function(){throw R=P=null,c()},D=function(){for(var e,t,n,r,i,o=P,s=o.length;R<s;)switch(i=o.charCodeAt(R)){case 9:case 10:case 13:case 32:R++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=w?o.charAt(R):o[R],R++,e;case 34:for(e="@",R++;R<s;)if((i=o.charCodeAt(R))<32)N();else if(92==i)switch(i=o.charCodeAt(++R)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=U[i],R++;break;case 117:for(t=++R,n=R+4;R<n;R++)(i=o.charCodeAt(R))>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||N();e+=x("0x"+o.slice(t,R));break;default:N()}else{if(34==i)break;for(i=o.charCodeAt(R),t=R;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++R);e+=o.slice(t,R)}if(34==o.charCodeAt(R))return R++,e;N();default:if(t=R,45==i&&(r=!0,i=o.charCodeAt(++R)),i>=48&&i<=57){for(48==i&&((i=o.charCodeAt(R+1))>=48&&i<=57)&&N(),r=!1;R<s&&((i=o.charCodeAt(R))>=48&&i<=57);R++);if(46==o.charCodeAt(R)){for(n=++R;n<s&&!((i=o.charCodeAt(n))<48||i>57);n++);n==R&&N(),R=n}if(101==(i=o.charCodeAt(R))||69==i){for(43!=(i=o.charCodeAt(++R))&&45!=i||R++,n=R;n<s&&!((i=o.charCodeAt(n))<48||i>57);n++);n==R&&N(),R=n}return+o.slice(t,R)}r&&N();var a=o.slice(R,R+4);if("true"==a)return R+=4,!0;if("fals"==a&&101==o.charCodeAt(R+4))return R+=5,!1;if("null"==a)return R+=4,null;N()}return"$"},L=function(e){var t,n;if("$"==e&&N(),"string"==typeof e){if("@"==(w?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=D());)n?","==e?"]"==(e=D())&&N():N():n=!0,","==e&&N(),t.push(L(e));return t}if("{"==e){for(t={};"}"!=(e=D());)n?","==e?"}"==(e=D())&&N():N():n=!0,","!=e&&"string"==typeof e&&"@"==(w?e.charAt(0):e[0])&&":"==D()||N(),t[e.slice(1)]=L(D());return t}N()}return e},M=function(e,t,n){var r=B(e,t,n);r===p?delete e[t]:e[t]=r},B=function(e,t,n){var r,i=e[t];if("object"==typeof i&&i)if("[object Array]"==g.call(i))for(r=i.length;r--;)M(g,k,i);else k(i,(function(e){M(i,e,n)}));return n.call(e,t,i)};t.parse=function(e,t){var n,r;return R=0,P=""+e,n=L(D()),"$"!=D()&&N(),R=P=null,t&&"[object Function]"==g.call(t)?B(((r={})[""]=n,r),"",t):n}}}return t.runInContext=s,t}if(!o||o.global!==o&&o.window!==o&&o.self!==o||(i=o),r)s(i,r);else{var a=i.JSON,u=i.JSON3,c=!1,l=s(i,i.JSON3={noConflict:function(){return c||(c=!0,i.JSON=a,i.JSON3=u,a=u=null),l}});i.JSON={parse:l.parse,stringify:l.stringify}}}).call(S)})),ot=j((function(e,t){function n(e){switch(e){case"http:":return 80;case"https:":return 443;default:return location.port}}t.parse=function(e){var t=document.createElement("a");return t.href=e,{href:t.href,host:t.host||location.host,port:"0"===t.port||""===t.port?n(t.protocol):t.port,hash:t.hash,hostname:t.hostname||location.hostname,pathname:"/"!=t.pathname.charAt(0)?"/"+t.pathname:t.pathname,protocol:t.protocol&&":"!=t.protocol?t.protocol:location.protocol,search:t.search,query:t.search.slice(1)}},t.isAbsolute=function(e){return 0==e.indexOf("//")||!!~e.indexOf("://")},t.isRelative=function(e){return!t.isAbsolute(e)},t.isCrossDomain=function(e){e=t.parse(e);var n=t.parse(window.location.href);return e.hostname!==n.hostname||e.port!==n.port||e.protocol!==n.protocol}})),st=(ot.parse,ot.isAbsolute,ot.isRelative,ot.isCrossDomain,j((function(e,t){var n=ot.parse;function r(e){for(var n=t.cookie,r=t.levels(e),i=0;i<r.length;++i){var o=r[i],s={domain:"."+o};if(n("__tld__",1,s),n("__tld__"))return n("__tld__",null,s),o}return""}r.levels=function(e){var t=n(e).hostname.split("."),r=t[t.length-1],i=[];if(4===t.length&&r===parseInt(r,10))return i;if(t.length<=1)return i;for(var o=t.length-2;o>=0;--o)i.push(t.slice(o).join("."));return i},r.cookie=Me,t=e.exports=r}))),at=new(function(){function e(t){n(this,e),this._options={},this.options(t)}return i(e,[{key:"options",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===arguments.length)return this._options;var t="."+st(window.location.href);"."===t&&(t=null),this._options=nt(e,{maxage:31536e6,path:"/",domain:t}),this.set("test_rudder",!0),this.get("test_rudder")||(this._options.domain=null),this.remove("test_rudder")}},{key:"set",value:function(e,t){try{return t=it.stringify(t),Me(e,t,Ce(this._options)),!0}catch(e){return!1}}},{key:"get",value:function(e){try{var t=Me(e);return t=t?it.parse(t):null}catch(e){return null}}},{key:"remove",value:function(e){try{return Me(e,null,Ce(this._options)),!0}catch(e){return!1}}}]),e}())({}),ut=function(){var e,t={},n="undefined"!=typeof window?window:S,r=n.document,i="localStorage";if(t.disabled=!1,t.version="1.3.20",t.set=function(e,t){},t.get=function(e,t){},t.has=function(e){return void 0!==t.get(e)},t.remove=function(e){},t.clear=function(){},t.transact=function(e,n,r){null==r&&(r=n,n=null),null==n&&(n={});var i=t.get(e,n);r(i),t.set(e,i)},t.getAll=function(){var e={};return t.forEach((function(t,n){e[t]=n})),e},t.forEach=function(){},t.serialize=function(e){return it.stringify(e)},t.deserialize=function(e){if("string"==typeof e)try{return it.parse(e)}catch(t){return e||void 0}},function(){try{return i in n&&n[i]}catch(e){return!1}}())e=n[i],t.set=function(n,r){return void 0===r?t.remove(n):(e.setItem(n,t.serialize(r)),r)},t.get=function(n,r){var i=t.deserialize(e.getItem(n));return void 0===i?r:i},t.remove=function(t){e.removeItem(t)},t.clear=function(){e.clear()},t.forEach=function(n){for(var r=0;r<e.length;r++){var i=e.key(r);n(i,t.get(i))}};else if(r&&r.documentElement.addBehavior){var o,s;try{(s=new ActiveXObject("htmlfile")).open(),s.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),s.close(),o=s.w.frames[0].document,e=o.createElement("div")}catch(t){e=r.createElement("div"),o=r.body}var a=function(n){return function(){var r=Array.prototype.slice.call(arguments,0);r.unshift(e),o.appendChild(e),e.addBehavior("#default#userData"),e.load(i);var s=n.apply(t,r);return o.removeChild(e),s}},u=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),c=function(e){return e.replace(/^d/,"___$&").replace(u,"___")};t.set=a((function(e,n,r){return n=c(n),void 0===r?t.remove(n):(e.setAttribute(n,t.serialize(r)),e.save(i),r)})),t.get=a((function(e,n,r){n=c(n);var i=t.deserialize(e.getAttribute(n));return void 0===i?r:i})),t.remove=a((function(e,t){t=c(t),e.removeAttribute(t),e.save(i)})),t.clear=a((function(e){var t=e.XMLDocument.documentElement.attributes;e.load(i);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(i)})),t.forEach=a((function(e,n){for(var r,i=e.XMLDocument.documentElement.attributes,o=0;r=i[o];++o)n(r.name,t.deserialize(e.getAttribute(r.name)))}))}try{var l="__storejs__";t.set(l,l),t.get(l)!=l&&(t.disabled=!0),t.remove(l)}catch(e){t.disabled=!0}return t.enabled=!t.disabled,t}(),ct=new(function(){function e(t){n(this,e),this._options={},this.enabled=!1,this.options(t)}return i(e,[{key:"options",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===arguments.length)return this._options;nt(e,{enabled:!0}),this.enabled=e.enabled&&ut.enabled,this._options=e}},{key:"set",value:function(e,t){return!!this.enabled&&ut.set(e,t)}},{key:"get",value:function(e){return this.enabled?ut.get(e):null}},{key:"remove",value:function(e){return!!this.enabled&&ut.remove(e)}}]),e}())({}),lt="rl_user_id",dt="rl_trait",ft="rl_anonymous_id",pt="rl_group_id",ht="rl_group_trait",gt=new(function(){function e(){if(n(this,e),at.set("rudder_cookies",!0),at.get("rudder_cookies"))return at.remove("rudder_cookies"),void(this.storage=at);ct.enabled&&(this.storage=ct)}return i(e,[{key:"setItem",value:function(e,t){this.storage.set(e,t)}},{key:"setUserId",value:function(e){"string"==typeof e?this.storage.set(lt,e):l.error("userId should be string")}},{key:"setUserTraits",value:function(e){this.storage.set(dt,e)}},{key:"setGroupId",value:function(e){"string"==typeof e?this.storage.set(pt,e):l.error("groupId should be string")}},{key:"setGroupTraits",value:function(e){this.storage.set(ht,e)}},{key:"setAnonymousId",value:function(e){"string"==typeof e?this.storage.set(ft,e):l.error("anonymousId should be string")}},{key:"getItem",value:function(e){return this.storage.get(e)}},{key:"getUserId",value:function(){return this.storage.get(lt)}},{key:"getUserTraits",value:function(){return this.storage.get(dt)}},{key:"getGroupId",value:function(){return this.storage.get(pt)}},{key:"getGroupTraits",value:function(){return this.storage.get(ht)}},{key:"getAnonymousId",value:function(){return this.storage.get(ft)}},{key:"removeItem",value:function(e){return this.storage.remove(e)}},{key:"clear",value:function(){this.storage.remove(lt),this.storage.remove(dt),this.storage.remove(ft)}}]),e}()),yt="lt_synch_timestamp",mt=new(function(){function e(){n(this,e),this.storage=gt}return i(e,[{key:"setLotameSynchTime",value:function(e){this.storage.setItem(yt,e)}},{key:"getLotameSynchTime",value:function(){return this.storage.getItem(yt)}}]),e}()),vt={HS:_,GA:E,HOTJAR:I,GOOGLEADS:A,VWO:T,GTM:C,BRAZE:O,INTERCOM:B,KEEN:F,KISSMETRICS:fe,CUSTOMERIO:pe,CHARTBEAT:Ie,COMSCORE:Ae,LOTAME:function(){function e(t){var r=this;n(this,e),this.name="LOTAME",this.storage=mt,this.bcpUrlSettings=t.bcpUrlSettings,this.dspUrlSettings=t.dspUrlSettings,this.mappings={},t.mappings.forEach((function(e){var t=e.key,n=e.value;r.mappings[t]=n}))}return i(e,[{key:"init",value:function(){l.debug("===in init Lotame==="),window.LOTAME_SYNCH_CALLBACK=function(){}}},{key:"addPixel",value:function(e,t,n){var r=document.createElement("img");r.src=e,r.setAttribute("width",t),r.setAttribute("height",n),document.getElementsByTagName("body")[0].appendChild(r)}},{key:"synchPixel",value:function(e){var t=this;l.debug("===== in synchPixel ======"),this.dspUrlSettings&&this.dspUrlSettings.length>0&&this.dspUrlSettings.forEach((function(n){var r=t.compileUrl(a({},t.mappings,{userId:e}),n.dspUrlTemplate);t.addPixel(r,"1","1")})),this.storage.setLotameSynchTime(Date.now()),window.LOTAME_SYNCH_CALLBACK&&"function"==typeof window.LOTAME_SYNCH_CALLBACK&&(l.debug("===== in synchPixel callback======"),window.LOTAME_SYNCH_CALLBACK())}},{key:"compileUrl",value:function(e,t){return Object.keys(e).forEach((function(n){if(e.hasOwnProperty(n)){var r=new RegExp("{{"+n+"}}","gi");t=t.replace(r,e[n])}})),t}},{key:"identify",value:function(e){l.debug("in Lotame identify");var t=e.message.userId;this.synchPixel(t)}},{key:"track",value:function(e){l.debug("track not supported for lotame")}},{key:"page",value:function(e){var t=this;l.debug("in Lotame page"),this.bcpUrlSettings&&this.bcpUrlSettings.length>0&&this.bcpUrlSettings.forEach((function(e){var n=t.compileUrl(a({},t.mappings),e.bcpUrlTemplate);t.addPixel(n,"1","1")})),e.message.userId&&this.isPixelToBeSynched()&&this.synchPixel(e.message.userId)}},{key:"isPixelToBeSynched",value:function(){var e=this.storage.getLotameSynchTime(),t=Date.now();return!e||Math.floor((t-e)/864e5)>=7}},{key:"isLoaded",value:function(){return l.debug("in Lotame isLoaded"),!0}},{key:"isReady",value:function(){return!0}}]),e}()},bt=function e(){n(this,e),this.build="1.0.0",this.name="RudderLabs JavaScript SDK",this.namespace="com.rudderlabs.javascript",this.version="1.1.1-rc.2"},wt=function e(){n(this,e),this.name="RudderLabs JavaScript SDK",this.version="1.1.1-rc.2"},kt=function e(){n(this,e),this.name="",this.version=""},_t=function e(){n(this,e),this.density=0,this.width=0,this.height=0},Et=function e(){n(this,e),this.app=new bt,this.traits=null,this.library=new wt;var t=new kt;t.version="";var r=new _t;r.width=window.width,r.height=window.height,r.density=window.devicePixelRatio,this.userAgent=navigator.userAgent,this.locale=navigator.language||navigator.browserLanguage,this.os=t,this.screen=r,this.device=null,this.network=null},It=function(){function e(){n(this,e),this.channel="web",this.context=new Et,this.type=null,this.action=null,this.messageId=f().toString(),this.originalTimestamp=(new Date).toISOString(),this.anonymousId=null,this.userId=null,this.event=null,this.properties={},this.integrations={},this.integrations.All=!0}return i(e,[{key:"getProperty",value:function(e){return this.properties[e]}},{key:"addProperty",value:function(e,t){this.properties[e]=t}},{key:"validateFor",value:function(e){if(!this.properties)throw new Error("Key properties is required");switch(e){case v.TRACK:if(!this.event)throw new Error("Key event is required for track event");if(this.event in Object.values(b))switch(this.event){case b.CHECKOUT_STEP_VIEWED:case b.CHECKOUT_STEP_COMPLETED:case b.PAYMENT_INFO_ENTERED:this.checkForKey("checkout_id"),this.checkForKey("step");break;case b.PROMOTION_VIEWED:case b.PROMOTION_CLICKED:this.checkForKey("promotion_id");break;case b.ORDER_REFUNDED:this.checkForKey("order_id")}else this.properties.category||(this.properties.category=this.event);break;case v.PAGE:break;case v.SCREEN:if(!this.properties.name)throw new Error("Key 'name' is required in properties")}}},{key:"checkForKey",value:function(e){if(!this.properties[e])throw new Error("Key '"+e+"' is required in properties")}}]),e}(),At=function(){function e(){n(this,e),this.message=new It}return i(e,[{key:"setType",value:function(e){this.message.type=e}},{key:"setProperty",value:function(e){this.message.properties=e}},{key:"setUserProperty",value:function(e){this.message.user_properties=e}},{key:"setUserId",value:function(e){this.message.userId=e}},{key:"setEventName",value:function(e){this.message.event=e}},{key:"updateTraits",value:function(e){this.message.context.traits=e}},{key:"getElementContent",value:function(){return this.message}}]),e}(),Tt=function(){function e(){n(this,e),this.rudderProperty=null,this.rudderUserProperty=null,this.event=null,this.userId=null,this.channel=null,this.type=null}return i(e,[{key:"setProperty",value:function(e){return this.rudderProperty=e,this}},{key:"setPropertyBuilder",value:function(e){return this.rudderProperty=e.build(),this}},{key:"setUserProperty",value:function(e){return this.rudderUserProperty=e,this}},{key:"setUserPropertyBuilder",value:function(e){return this.rudderUserProperty=e.build(),this}},{key:"setEvent",value:function(e){return this.event=e,this}},{key:"setUserId",value:function(e){return this.userId=e,this}},{key:"setChannel",value:function(e){return this.channel=e,this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"build",value:function(){var e=new At;return e.setUserId(this.userId),e.setType(this.type),e.setEventName(this.event),e.setProperty(this.rudderProperty),e.setUserProperty(this.rudderUserProperty),e}}]),e}(),Ct=function e(){n(this,e),this.batch=null,this.writeKey=null},Ot=j((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}})),St=[],jt=0;jt<256;++jt)St[jt]=(jt+256).toString(16).substr(1);var Rt,Pt,xt=function(e,t){var n=t||0,r=St;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")},Ut=0,Nt=0;var Dt=function(e,t,n){var r=t&&n||0,i=t||[],o=(e=e||{}).node||Rt,s=void 0!==e.clockseq?e.clockseq:Pt;if(null==o||null==s){var a=Ot();null==o&&(o=Rt=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==s&&(s=Pt=16383&(a[6]<<8|a[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:Nt+1,l=u-Ut+(c-Nt)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||u>Ut)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ut=u,Nt=c,Pt=s;var d=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var f=u/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var p=0;p<6;++p)i[r+p]=o[p];return t||xt(i)};var Lt=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||Ot)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||xt(i)},Mt=Lt;Mt.v1=Dt,Mt.v4=Lt;var Bt=Mt,Ft=Object.prototype.hasOwnProperty,Kt=String.prototype.charAt,qt=Object.prototype.toString,Gt=function(e,t){return Kt.call(e,t)},Ht=function(e,t){return Ft.call(e,t)},Vt=function(e,t){t=t||Ht;for(var n=[],r=0,i=e.length;r<i;r+=1)t(e,r)&&n.push(String(r));return n},zt=function(e){return null==e?[]:(t=e,"[object String]"===qt.call(t)?Vt(e,Gt):function(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}(e)?Vt(e,Ht):function(e,t){t=t||Ht;var n=[];for(var r in e)t(e,r)&&n.push(String(r));return n}(e));var t},Jt=Bt.v4,Wt={_data:{},length:0,setItem:function(e,t){return this._data[e]=t,this.length=zt(this._data).length,t},getItem:function(e){return e in this._data?this._data[e]:null},removeItem:function(e){return e in this._data&&delete this._data[e],this.length=zt(this._data).length,null},clear:function(){this._data={},this.length=0},key:function(e){return zt(this._data)[e]}};var Yt={defaultEngine:function(){try{if(!window.localStorage)return!1;var e=Jt();window.localStorage.setItem(e,"test_value");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"test_value"===t}catch(e){return!1}}()?window.localStorage:Wt,inMemoryEngine:Wt},$t=Object.prototype.toString,Qt="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===$t.call(e)},Zt=function(e){return null!=e&&(Qt(e)||"function"!==e&&function(e){var t=typeof e;return"number"===t||"object"===t&&"[object Number]"===$t.call(e)}(e.length))},Xt=function(e,t){for(var n=0;n<t.length&&!1!==e(t[n],n,t);n+=1);},en=function(e,t){for(var n=zt(t),r=0;r<n.length&&!1!==e(t[n[r]],n[r],t);r+=1);},tn=function(e,t){return(Zt(t)?Xt:en).call(this,e,t)},nn=Yt.defaultEngine,rn=Yt.inMemoryEngine;function on(e,t,n,r){this.id=t,this.name=e,this.keys=n||{},this.engine=r||nn}on.prototype.set=function(e,t){var n=this._createValidKey(e);if(n)try{this.engine.setItem(n,it.stringify(t))}catch(n){(function(e){var t=!1;if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t})(n)&&(this._swapEngine(),this.set(e,t))}},on.prototype.get=function(e){try{var t=this.engine.getItem(this._createValidKey(e));return null===t?null:it.parse(t)}catch(e){return null}},on.prototype.remove=function(e){this.engine.removeItem(this._createValidKey(e))},on.prototype._createValidKey=function(e){var t,n=this.name,r=this.id;return zt(this.keys).length?(tn((function(i){i===e&&(t=[n,r,e].join("."))}),this.keys),t):[n,r,e].join(".")},on.prototype._swapEngine=function(){var e=this;tn((function(t){var n=e.get(t);rn.setItem([e.name,e.id,t].join("."),n),e.remove(t)}),this.keys),this.engine=rn};var sn=on;var an={setTimeout:function(e,t){return window.setTimeout(e,t)},clearTimeout:function(e){return window.clearTimeout(e)},Date:window.Date},un=an;function cn(){this.tasks={},this.nextId=1}cn.prototype.now=function(){return+new un.Date},cn.prototype.run=function(e,t){var n=this.nextId++;return this.tasks[n]=un.setTimeout(this._handle(n,e),t),n},cn.prototype.cancel=function(e){this.tasks[e]&&(un.clearTimeout(this.tasks[e]),delete this.tasks[e])},cn.prototype.cancelAll=function(){tn(un.clearTimeout,this.tasks),this.tasks={}},cn.prototype._handle=function(e,t){var n=this;return function(){return delete n.tasks[e],t()}},cn.setClock=function(e){un=e},cn.resetClock=function(){un=an};var ln=cn,dn=fn;function fn(e){return fn.enabled(e)?function(t){t=pn(t);var n=new Date,r=n-(fn[e]||n);fn[e]=n,t=e+" "+t+" +"+fn.humanize(r),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function pn(e){return e instanceof Error?e.stack||e.message:e}fn.names=[],fn.skips=[],fn.enable=function(e){try{localStorage.debug=e}catch(e){}for(var t=(e||"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)"-"===(e=t[r].replace("*",".*?"))[0]?fn.skips.push(new RegExp("^"+e.substr(1)+"$")):fn.names.push(new RegExp("^"+e+"$"))},fn.disable=function(){fn.enable("")},fn.humanize=function(e){return e>=36e5?(e/36e5).toFixed(1)+"h":e>=6e4?(e/6e4).toFixed(1)+"m":e>=1e3?(e/1e3|0)+"s":e+"ms"},fn.enabled=function(e){for(var t=0,n=fn.skips.length;t<n;t++)if(fn.skips[t].test(e))return!1;for(t=0,n=fn.names.length;t<n;t++)if(fn.names[t].test(e))return!0;return!1};try{window.localStorage&&fn.enable(localStorage.debug)}catch(e){}var hn=j((function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}})),gn=Bt.v4,yn=dn("localstorage-retry");function mn(e,t){return function(){return e.apply(t,arguments)}}function vn(e,t,n){"function"==typeof t&&(n=t),this.name=e,this.id=gn(),this.fn=n,this.maxItems=t.maxItems||1/0,this.maxAttempts=t.maxAttempts||1/0,this.backoff={MIN_RETRY_DELAY:t.minRetryDelay||1e3,MAX_RETRY_DELAY:t.maxRetryDelay||3e4,FACTOR:t.backoffFactor||2,JITTER:t.backoffJitter||0},this.timeouts={ACK_TIMER:1e3,RECLAIM_TIMER:3e3,RECLAIM_TIMEOUT:1e4,RECLAIM_WAIT:500},this.keys={IN_PROGRESS:"inProgress",QUEUE:"queue",ACK:"ack",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd"},this._schedule=new ln,this._processId=0,this._store=new sn(this.name,this.id,this.keys),this._store.set(this.keys.IN_PROGRESS,{}),this._store.set(this.keys.QUEUE,[]),this._ack=mn(this._ack,this),this._checkReclaim=mn(this._checkReclaim,this),this._processHead=mn(this._processHead,this),this._running=!1}hn(vn.prototype),vn.prototype.start=function(){this._running&&this.stop(),this._running=!0,this._ack(),this._checkReclaim(),this._processHead()},vn.prototype.stop=function(){this._schedule.cancelAll(),this._running=!1},vn.prototype.shouldRetry=function(e,t){return!(t>this.maxAttempts)},vn.prototype.getDelay=function(e){var t=this.backoff.MIN_RETRY_DELAY*Math.pow(this.backoff.FACTOR,e);if(this.backoff.JITTER){var n=Math.random(),r=Math.floor(n*this.backoff.JITTER*t);Math.floor(10*n)<5?t-=r:t+=r}return Number(Math.min(t,this.backoff.MAX_RETRY_DELAY).toPrecision(1))},vn.prototype.addItem=function(e){this._enqueue({item:e,attemptNumber:0,time:this._schedule.now()})},vn.prototype.requeue=function(e,t,n){this.shouldRetry(e,t,n)?this._enqueue({item:e,attemptNumber:t,time:this._schedule.now()+this.getDelay(t)}):this.emit("discard",e,t)},vn.prototype._enqueue=function(e){var t=this._store.get(this.keys.QUEUE)||[];(t=t.slice(-(this.maxItems-1))).push(e),t=t.sort((function(e,t){return e.time-t.time})),this._store.set(this.keys.QUEUE,t),this._running&&this._processHead()},vn.prototype._processHead=function(){var e=this,t=this._store;this._schedule.cancel(this._processId);var n=t.get(this.keys.QUEUE)||[],r=t.get(this.keys.IN_PROGRESS)||{},i=this._schedule.now(),o=[];function s(n,r){o.push({item:n.item,done:function(i,o){var s=t.get(e.keys.IN_PROGRESS)||{};delete s[r],t.set(e.keys.IN_PROGRESS,s),e.emit("processed",i,o,n.item),i&&e.requeue(n.item,n.attemptNumber+1,i)}})}for(var a=Object.keys(r).length;n.length&&n[0].time<=i&&a++<e.maxItems;){var u=n.shift(),c=gn();r[c]={item:u.item,attemptNumber:u.attemptNumber,time:e._schedule.now()},s(u,c)}t.set(this.keys.QUEUE,n),t.set(this.keys.IN_PROGRESS,r),tn((function(t){try{e.fn(t.item,t.done)}catch(e){yn("Process function threw error: "+e)}}),o),n=t.get(this.keys.QUEUE)||[],this._schedule.cancel(this._processId),n.length>0&&(this._processId=this._schedule.run(this._processHead,n[0].time-i))},vn.prototype._ack=function(){this._store.set(this.keys.ACK,this._schedule.now()),this._store.set(this.keys.RECLAIM_START,null),this._store.set(this.keys.RECLAIM_END,null),this._schedule.run(this._ack,this.timeouts.ACK_TIMER)},vn.prototype._checkReclaim=function(){var e=this;tn((function(t){t.id!==e.id&&(e._schedule.now()-t.get(e.keys.ACK)<e.timeouts.RECLAIM_TIMEOUT||function(t){t.set(e.keys.RECLAIM_START,e.id),t.set(e.keys.ACK,e._schedule.now()),e._schedule.run((function(){t.get(e.keys.RECLAIM_START)===e.id&&(t.set(e.keys.RECLAIM_END,e.id),e._schedule.run((function(){t.get(e.keys.RECLAIM_END)===e.id&&t.get(e.keys.RECLAIM_START)===e.id&&e._reclaim(t.id)}),e.timeouts.RECLAIM_WAIT))}),e.timeouts.RECLAIM_WAIT)}(t))}),function(t){for(var n=[],r=e._store.engine,i=0;i<r.length;i++){var o=r.key(i).split(".");3===o.length&&(o[0]===t&&"ack"===o[2]&&n.push(new sn(t,o[1],e.keys)))}return n}(this.name)),this._schedule.run(this._checkReclaim,this.timeouts.RECLAIM_TIMER)},vn.prototype._reclaim=function(e){var t=this,n=new sn(this.name,e,this.keys),r={queue:this._store.get(this.keys.QUEUE)||[]},i={inProgress:n.get(this.keys.IN_PROGRESS)||{},queue:n.get(this.keys.QUEUE)||[]};tn((function(e){r.queue.push({item:e.item,attemptNumber:e.attemptNumber,time:t._schedule.now()})}),i.queue),tn((function(e){r.queue.push({item:e.item,attemptNumber:e.attemptNumber+1,time:t._schedule.now()})}),i.inProgress),r.queue=r.queue.sort((function(e,t){return e.time-t.time})),this._store.set(this.keys.QUEUE,r.queue),n.remove(this.keys.ACK),n.remove(this.keys.RECLAIM_START),n.remove(this.keys.RECLAIM_END),n.remove(this.keys.IN_PROGRESS),n.remove(this.keys.QUEUE),this._processHead()};var bn=vn,wn={maxRetryDelay:36e4,minRetryDelay:1e3,backoffFactor:0},kn=new(function(){function e(){n(this,e),this.eventsBuffer=[],this.writeKey="",this.url=w,this.state="READY",this.batchSize=0,this.payloadQueue=new bn("rudder",wn,(function(e,t){e.message.sentAt=p(),kn.processQueueElement(e.url,e.headers,e.message,1e4,(function(e,n){if(e)return t(e);t(null,n)}))})),this.payloadQueue.start()}return i(e,[{key:"preaparePayloadAndFlush",value:function(e){if(l.debug("==== in preaparePayloadAndFlush with state: "+e.state),l.debug(e.eventsBuffer),0!=e.eventsBuffer.length&&"PROCESSING"!==e.state){var t=e.eventsBuffer,n=new Ct;n.batch=t,n.writeKey=e.writeKey,n.sentAt=p(),n.batch.forEach((function(e){e.sentAt=n.sentAt})),e.batchSize=e.eventsBuffer.length;var r=new XMLHttpRequest;l.debug("==== in flush sending to Rudder BE ===="),l.debug(JSON.stringify(n,d)),r.open("POST",e.url,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Basic "+btoa(n.writeKey+":")),r.onreadystatechange=function(){4===r.readyState&&200===r.status?(l.debug("====== request processed successfully: "+r.status),e.eventsBuffer=e.eventsBuffer.slice(e.batchSize),l.debug(e.eventsBuffer.length)):4===r.readyState&&200!==r.status&&h(new Error("request failed with status: "+r.status+" for url: "+e.url)),e.state="READY"},r.send(JSON.stringify(n,d)),e.state="PROCESSING"}}},{key:"processQueueElement",value:function(e,t,n,r,i){try{var o=new XMLHttpRequest;for(var s in o.open("POST",e,!0),t)o.setRequestHeader(s,t[s]);o.timeout=r,o.ontimeout=i,o.onerror=i,o.onreadystatechange=function(){4===o.readyState&&(429===o.status||o.status>=500&&o.status<600?(h(new Error("request failed with status: "+o.status+o.statusText+" for url: "+e)),i(new Error("request failed with status: "+o.status+o.statusText+" for url: "+e))):(l.debug("====== request processed successfully: "+o.status),i(null,o.status)))},o.send(JSON.stringify(n,d))}catch(e){i(e)}}},{key:"enqueue",value:function(e,t){var n={"Content-Type":"application/json",Authorization:"Basic "+btoa(this.writeKey+":")},r=e.getElementContent();r.originalTimestamp=p(),r.sentAt=p(),JSON.stringify(r).length>32e3&&l.error("message length greater 32 Kb ",r);var i="/"==this.url.slice(-1)?this.url.slice(0,-1):this.url;this.payloadQueue.addItem({url:i+"/v1/"+t,headers:n,message:r})}}]),e}());function _n(e){var t=function(t){var n=(t=t||window.event).target||t.srcElement;Cn(n)&&(n=n.parentNode),In(n,t)?l.debug("to be tracked ",t.type):l.debug("not to be tracked ",t.type),function(e,t){var n=e.target||e.srcElement,r=void 0;Cn(n)&&(n=n.parentNode);if(In(n,e)){if("form"==n.tagName.toLowerCase()){r={};for(var i=0;i<n.elements.length;i++){var o=n.elements[i];if(jn(o)&&Sn(o,t.trackValues)){var s=o.id?o.id:o.name;if(s&&"string"==typeof s){var a=o.id?o.id:o.name,u=o.id?document.getElementById(o.id).value:document.getElementsByName(o.name)[0].value;"checkbox"!==o.type&&"radio"!==o.type||(u=o.checked),""!==a.trim()&&(r[encodeURIComponent(a)]=encodeURIComponent(u))}}}}for(var c=[n],d=n;d.parentNode&&!An(d,"body");)c.push(d.parentNode),d=d.parentNode;var f,p=[],h=!1;if(c.forEach((function(e){var n=function(e){return!(!e.parentNode||An(e,"body"))}(e);"a"===e.tagName.toLowerCase()&&(f=e.getAttribute("href"),f=n&&f),h=h||!jn(e),p.push(function(e,t){for(var n={classes:On(e).split(" "),tag_name:e.tagName.toLowerCase()},r=e.attributes.length,i=0;i<r;i++){var o=e.attributes[i].name,s=e.attributes[i].value;s&&(n["attr__"+o]=s),"name"!=o&&"id"!=o||!Sn(e,t.trackValues)||(n.field_value="id"==o?document.getElementById(s).value:document.getElementsByName(s)[0].value,"checkbox"!==e.type&&"radio"!==e.type||(n.field_value=e.checked))}var a=1,u=1,c=e;for(;c=Rn(c);)a++,c.tagName===e.tagName&&u++;return n.nth_child=a,n.nth_of_type=u,n}(e,t))})),h)return!1;var y="",m=function(e){var t="";return e.childNodes.forEach((function(e){e.nodeType===Node.TEXT_NODE&&(t+=e.nodeValue)})),t.trim()}(n);m&&m.length&&(y=m);var v={event_type:e.type,page:g(),elements:p,el_attr_href:f,el_text:y};r&&(v.form_values=r),l.debug("web_event",v),t.track("autotrack",v)}}(t,e)};En(document,"submit",t,!0),En(document,"change",t,!0),En(document,"click",t,!0),e.page()}function En(e,t,n,r){e?e.addEventListener(t,n,!!r):l.error("No valid element provided to register_event")}function In(e,t){if(!e||An(e,"html")||!Tn(e))return!1;switch(e.tagName.toLowerCase()){case"html":return!1;case"form":return"submit"===t.type;case"input":return-1===["button","submit"].indexOf(e.getAttribute("type"))?"change"===t.type:"click"===t.type;case"select":case"textarea":return"change"===t.type;default:return"click"===t.type}}function An(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function Tn(e){return e&&1===e.nodeType}function Cn(e){return e&&3===e.nodeType}function On(e){switch(t(e.className)){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}}function Sn(e,t){for(var n=e.attributes.length,r=0;r<n;r++){var i=e.attributes[r].value;if(t.indexOf(i)>-1)return!0}return!1}function jn(e){return!(On(e).split(" ").indexOf("rudder-no-track")>=0)}function Rn(e){if(e.previousElementSibling)return e.previousElementSibling;do{e=e.previousSibling}while(e&&!Tn(e));return e}var Pn=function(e,t,n){var r=!1;return n=n||xn,i.count=e,0===e?t():i;function i(e,o){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(r=!0,t(e),t=n):0!==i.count||r||t(null,o)}};function xn(){}function Un(e,t){this.eventRepository||(this.eventRepository=kn),this.eventRepository.enqueue(e,t)}var Nn=function(){function e(){n(this,e),this.autoTrackHandlersRegistered=!1,this.autoTrackFeatureEnabled=!1,this.initialized=!1,this.trackValues=[],this.eventsBuffer=[],this.clientIntegrations=[],this.configArray=[],this.clientIntegrationObjects=void 0,this.successfullyLoadedIntegration=[],this.failedToBeLoadedIntegration=[],this.toBeProcessedArray=[],this.toBeProcessedByIntegrationArray=[],this.storage=gt,this.userId=null!=this.storage.getUserId()?this.storage.getUserId():"",this.userTraits=null!=this.storage.getUserTraits()?this.storage.getUserTraits():{},this.groupId=null!=this.storage.getGroupId()?this.storage.getGroupId():"",this.groupTraits=null!=this.storage.getGroupTraits()?this.storage.getGroupTraits():{},this.anonymousId=this.getAnonymousId(),this.storage.setUserId(this.userId),this.eventRepository=kn,this.readyCallback=function(){},this.executeReadyCallback=void 0}return i(e,[{key:"processResponse",value:function(e,t){try{l.debug("===in process response=== "+e),(t=JSON.parse(t)).source.useAutoTracking&&!this.autoTrackHandlersRegistered&&(this.autoTrackFeatureEnabled=!0,_n(this),this.autoTrackHandlersRegistered=!0),t.source.destinations.forEach((function(e,t){l.debug("Destination "+t+" Enabled? "+e.enabled+" Type: "+e.destinationDefinition.name+" Use Native SDK? "+e.config.useNativeSDK),e.enabled&&(this.clientIntegrations.push(e.destinationDefinition.name),this.configArray.push(e.config))}),this),this.init(this.clientIntegrations,this.configArray)}catch(e){h(e),l.debug("===handling config BE response processing error==="),l.debug("autoTrackHandlersRegistered",this.autoTrackHandlersRegistered),this.autoTrackFeatureEnabled&&!this.autoTrackHandlersRegistered&&(_n(this),this.autoTrackHandlersRegistered=!0)}}},{key:"init",value:function(e,t){var n=this,r=this;if(l.debug("supported intgs ",vt),!e||0==e.length)return this.readyCallback&&this.readyCallback(),void(this.toBeProcessedByIntegrationArray=[]);e.forEach((function(e,i){var o=new(0,vt[e])(t[i],r);o.init(),l.debug("initializing destination: ",e),n.isInitialized(o).then(n.replayEvents)}))}},{key:"replayEvents",value:function(e){e.successfullyLoadedIntegration.length+e.failedToBeLoadedIntegration.length==e.clientIntegrations.length&&(e.clientIntegrationObjects=[],e.clientIntegrationObjects=e.successfullyLoadedIntegration,e.executeReadyCallback=Pn(e.clientIntegrationObjects.length,e.readyCallback),e.on("ready",e.executeReadyCallback),e.clientIntegrationObjects.forEach((function(t){t.isReady&&!t.isReady()||e.emit("ready")})),e.toBeProcessedByIntegrationArray.forEach((function(t){var n=t[0];t.shift();for(var r=t[0].message.integrations,i=0;i<e.clientIntegrationObjects.length;i++)if(r[e.clientIntegrationObjects[i].name]||null==r[e.clientIntegrationObjects[i].name]&&r.All)try{var o;if(!e.clientIntegrationObjects[i].isFailed||!e.clientIntegrationObjects[i].isFailed())(o=e.clientIntegrationObjects[i])[n].apply(o,u(t))}catch(e){h(e)}})),e.toBeProcessedByIntegrationArray=[])}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"isInitialized",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return e.isLoaded()?(t.successfullyLoadedIntegration.push(e),r(t)):n>=1e4?(l.debug("====max wait over===="),t.failedToBeLoadedIntegration.push(e),r(t)):void t.pause(1e3).then((function(){return t.isInitialized(e,n+1e3).then(r)}))}))}},{key:"page",value:function(e,n,r,i,o){"function"==typeof i&&(o=i,i=null),"function"==typeof r&&(o=r,i=r=null),"function"==typeof n&&(o=n,i=r=n=null),"object"===t(e)&&(i=n,r=e,n=e=null),"object"===t(n)&&(i=r,r=n,n=null),"string"==typeof e&&"string"!=typeof n&&(n=e,e=null),this.processPage(e,n,r,i,o)}},{key:"track",value:function(e,t,n,r){"function"==typeof n&&(r=n,n=null),"function"==typeof t&&(r=t,n=null,t=null),this.processTrack(e,t,n,r)}},{key:"identify",value:function(e,n,r,i){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(e)&&(r=n,n=e,e=this.userId),this.processIdentify(e,n,r,i)}},{key:"alias",value:function(e,n,r,i){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(n)&&(r=n,n=null);var o=(new Tt).setType("alias").build();o.message.previousId=n||this.userId?this.userId:this.getAnonymousId(),o.message.userId=e,this.processAndSendDataToDestinations("alias",o,r,i)}},{key:"group",value:function(e,n,r,i){if(arguments.length){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(e)&&(r=n,n=e,e=this.groupId),this.groupId=e,this.storage.setGroupId(this.groupId);var o=(new Tt).setType("group").build();if(n)for(var s in n)this.groupTraits[s]=n[s];else this.groupTraits={};this.storage.setGroupTraits(this.groupTraits),this.processAndSendDataToDestinations("group",o,r,i)}}},{key:"processPage",value:function(e,t,n,r,i){var o=(new Tt).setType("page").build();t&&(o.message.name=t),n||(n={}),e&&(n.category=e),n&&(o.message.properties=this.getPageProperties(n)),this.trackPage(o,r,i)}},{key:"processTrack",value:function(e,t,n,r){var i=(new Tt).setType("track").build();e&&i.setEventName(e),t?i.setProperty(t):i.setProperty({}),this.trackEvent(i,n,r)}},{key:"processIdentify",value:function(e,t,n,r){e&&this.userId&&e!==this.userId&&this.reset(),this.userId=e,this.storage.setUserId(this.userId);var i=(new Tt).setType("identify").build();if(t){for(var o in t)this.userTraits[o]=t[o];this.storage.setUserTraits(this.userTraits)}this.identifyUser(i,n,r)}},{key:"identifyUser",value:function(e,t,n){e.message.userId&&(this.userId=e.message.userId,this.storage.setUserId(this.userId)),e&&e.message&&e.message.context&&e.message.context.traits&&(this.userTraits=Object.assign({},e.message.context.traits),this.storage.setUserTraits(this.userTraits)),this.processAndSendDataToDestinations("identify",e,t,n)}},{key:"trackPage",value:function(e,t,n){this.processAndSendDataToDestinations("page",e,t,n)}},{key:"trackEvent",value:function(e,t,n){this.processAndSendDataToDestinations("track",e,t,n)}},{key:"processAndSendDataToDestinations",value:function(e,t,n,r){try{this.anonymousId||this.setAnonymousId(),t.message.context.page=g(),t.message.context.traits=Object.assign({},this.userTraits),l.debug("anonymousId: ",this.anonymousId),t.message.anonymousId=this.anonymousId,t.message.userId=t.message.userId?t.message.userId:this.userId,"group"==e&&(this.groupId&&(t.message.groupId=this.groupId),this.groupTraits&&(t.message.traits=Object.assign({},this.groupTraits))),n&&this.processOptionsParam(t,n),l.debug(JSON.stringify(t));var i=t.message.integrations;this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(n){l.debug("called in normal flow"),(i[n.name]||null==i[n.name]&&i.All)&&(n.isFailed&&n.isFailed()||n[e](t))})),this.clientIntegrationObjects||(l.debug("pushing in replay queue"),this.toBeProcessedByIntegrationArray.push([e,t])),Un.call(this,t,e),l.debug(e+" is called "),r&&r()}catch(e){h(e)}}},{key:"processOptionsParam",value:function(e,t){var n=["integrations","anonymousId","originalTimestamp"];for(var r in t)if(n.includes(r))e.message[r]=t[r];else if("context"!==r)e.message.context[r]=t[r];else for(var i in t[r])e.message.context[i]=t[r][i]}},{key:"getPageProperties",value:function(e){var t=g();for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e}},{key:"reset",value:function(){this.userId="",this.userTraits={},this.anonymousId=this.setAnonymousId(),this.storage.clear()}},{key:"getAnonymousId",value:function(){return this.anonymousId=this.storage.getAnonymousId(),this.anonymousId||this.setAnonymousId(),this.anonymousId}},{key:"setAnonymousId",value:function(e){this.anonymousId=e||f(),this.storage.setAnonymousId(this.anonymousId)}},{key:"load",value:function(e,t,n){var r="https://api.rudderlabs.com/sourceConfig";if(!e||!t||0==t.length)throw h({message:"Unable to load due to wrong writeKey or serverUrl"}),Error("failed to initialize");n&&n.logLevel&&l.setLogLevel(n.logLevel),n&&n.configUrl&&(r=n.configUrl),l.debug("inside load "),this.eventRepository.writeKey=e,t&&(this.eventRepository.url=t),n&&n.valTrackingList&&n.valTrackingList.push==Array.prototype.push&&(this.trackValues=n.valTrackingList),n&&n.useAutoTracking&&(this.autoTrackFeatureEnabled=!0,this.autoTrackFeatureEnabled&&!this.autoTrackHandlersRegistered&&(_n(this),this.autoTrackHandlersRegistered=!0,l.debug("autoTrackHandlersRegistered",this.autoTrackHandlersRegistered)));try{!function(e,t,n,r){var i,o=r.bind(e);(i=new XMLHttpRequest).open("GET",t,!0),i.setRequestHeader("Authorization","Basic "+btoa(n+":")),i.onload=function(){var e=i.status;200==e?(l.debug("status 200 calling callback"),o(200,i.responseText)):(h(new Error("request failed with status: "+i.status+" for url: "+t)),o(e))},i.send()}(this,r,e,this.processResponse)}catch(e){h(e),this.autoTrackFeatureEnabled&&!this.autoTrackHandlersRegistered&&_n(Dn)}}},{key:"ready",value:function(e){"function"!=typeof e?l.error("ready callback is not a function"):this.readyCallback=e}}]),e}();window.addEventListener("error",(function(e){h(e)}),!0);var Dn=new Nn;hn(Dn);var Ln=!!window.rudderanalytics&&window.rudderanalytics.push==Array.prototype.push,Mn=window.rudderanalytics?window.rudderanalytics[0]:[];if(Mn.length>0&&"load"==Mn[0]){var Bn=Mn[0];Mn.shift(),Dn[Bn].apply(Dn,u(Mn))}if(Ln){for(var Fn=1;Fn<window.rudderanalytics.length;Fn++)Dn.toBeProcessedArray.push(window.rudderanalytics[Fn]);for(var Kn=0;Kn<Dn.toBeProcessedArray.length;Kn++){var qn=u(Dn.toBeProcessedArray[Kn]),Gn=qn[0];qn.shift(),Dn[Gn].apply(Dn,u(qn))}Dn.toBeProcessedArray=[]}var Hn=Dn.ready.bind(Dn),Vn=Dn.identify.bind(Dn),zn=Dn.page.bind(Dn),Jn=Dn.track.bind(Dn),Wn=Dn.alias.bind(Dn),Yn=Dn.group.bind(Dn),$n=Dn.reset.bind(Dn),Qn=Dn.load.bind(Dn),Zn=Dn.initialized=!0,Xn=Dn.getAnonymousId.bind(Dn),er=Dn.setAnonymousId.bind(Dn);return e.alias=Wn,e.getAnonymousId=Xn,e.group=Yn,e.identify=Vn,e.initialized=Zn,e.load=Qn,e.page=zn,e.ready=Hn,e.reset=$n,e.setAnonymousId=er,e.track=Jn,e}({});
